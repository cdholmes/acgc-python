<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.2.0"/>
    <title>acgc.solar API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../acgc.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;acgc</a>

            <img src="https://acgc.eoas.fsu.edu/wiki/_media/wiki/logo.png" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#pi180">pi180</a>
            </li>
            <li>
                    <a class="function" href="#solar_azimuth_angle">solar_azimuth_angle</a>
            </li>
            <li>
                    <a class="function" href="#solar_elevation_angle">solar_elevation_angle</a>
            </li>
            <li>
                    <a class="function" href="#solar_zenith_angle">solar_zenith_angle</a>
            </li>
            <li>
                    <a class="function" href="#equation_of_time">equation_of_time</a>
            </li>
            <li>
                    <a class="function" href="#horizon_zenith_angle">horizon_zenith_angle</a>
            </li>
            <li>
                    <a class="function" href="#solar_declination">solar_declination</a>
            </li>
            <li>
                    <a class="function" href="#solar_hour_angle">solar_hour_angle</a>
            </li>
            <li>
                    <a class="function" href="#refraction_angle">refraction_angle</a>
            </li>
            <li>
                    <a class="function" href="#sza">sza</a>
            </li>
            <li>
                    <a class="function" href="#saa">saa</a>
            </li>
            <li>
                    <a class="function" href="#sea">sea</a>
            </li>
            <li>
                    <a class="function" href="#equationOfTime">equationOfTime</a>
            </li>
            <li>
                    <a class="function" href="#solarDeclination">solarDeclination</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../acgc.html">acgc</a><wbr>.solar    </h1>

                        <div class="docstring"><p>Module to calculate solar zenith angle, solar declination, and equation of time 
Results should be accurate to &lt; 0.1 degree, but other modules should be used for 
high-precision calculations.</p>

<p>C.D. Holmes 9 Nov 2018</p>
</div>

                        <input id="mod-solar-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-solar-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="ch">#!/usr/local/bin/env python3</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">&#39;&#39;&#39; Module to calculate solar zenith angle, solar declination, and equation of time </span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">Results should be accurate to &lt; 0.1 degree, but other modules should be used for </span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">high-precision calculations.</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">C.D. Holmes 9 Nov 2018</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">import</span> <span class="nn">warnings</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="n">pi180</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="k">def</span> <span class="nf">solar_azimuth_angle</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span> <span class="p">):</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Solar azimuth angle (degrees) for a latitude, longitude, date and time</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="sd">    </span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="sd">    SAA is degrees clockwise from north.</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="sd">    </span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="sd">    Parameters</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="sd">    ----------</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="sd">    lat : float or ndarray</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">        latitude in degrees</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">    lon : float or ndarray</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">        longitudes in degrees</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">    datetimeUTC : pandas.Timestamp, datetime, or str</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">        date and time in UTC</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">    Returns</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">    -------</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">    saa : float or ndarray</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">        solar azimuth angle in degrees (clockwise from north)</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>    <span class="c1"># Convert to pandas Timestamp, if needed</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>    <span class="n">datetimeUTC</span> <span class="o">=</span> <span class="n">_to_timestamp</span><span class="p">(</span><span class="n">datetimeUTC</span><span class="p">)</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>    <span class="c1"># Solar declination, degrees</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>    <span class="n">dec</span> <span class="o">=</span> <span class="n">solar_declination</span><span class="p">(</span> <span class="n">datetimeUTC</span> <span class="p">)</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>    <span class="c1"># Hour angle, degrees</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>    <span class="n">Ha</span> <span class="o">=</span> <span class="n">solar_hour_angle</span><span class="p">(</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span> <span class="p">)</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>    <span class="c1"># Solar zenith angle, degrees</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>    <span class="c1"># Use true sza, without refraction</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>    <span class="n">zen</span> <span class="o">=</span> <span class="n">sza</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span><span class="p">,</span> <span class="n">refraction</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>    <span class="c1"># Solar azimuth angle, degrees</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>    <span class="n">saa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">Ha</span><span class="o">*</span><span class="n">pi180</span> <span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span> <span class="n">dec</span><span class="o">*</span><span class="n">pi180</span> <span class="p">)</span> <span class="o">/</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">zen</span><span class="o">*</span><span class="n">pi180</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">pi180</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>    <span class="c1"># Change range [-180,180] to [0,360]</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span> <span class="n">saa</span><span class="o">+</span><span class="mi">360</span><span class="p">,</span> <span class="mi">360</span> <span class="p">)</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="k">def</span> <span class="nf">solar_elevation_angle</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">datetimeUTC</span><span class="p">,</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>                       <span class="n">refraction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="mf">101325.</span> <span class="p">):</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Solar elevation angle (degrees) above the horizon</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">    The altitude parameter should be the vertical distance </span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">    above the surrounding terrain that defines the horizon,</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">    not necessarily the altitude above sea level or the altitude above ground level.</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">    For example, on a mountain peak that is 4000 m above sea level and </span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">    1500 m above the surrounding plateau, the relevant altitude is 1500 m.</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">    For an observer on the plateau, the relevant altitude is 0 m.</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">    See documentation for `solar_zenith_angle` and `horizon_zenith_angle`.</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">    Parameters</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">    ----------</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">    lat : float or ndarray</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">        latitude in degrees</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">    lon : float or ndarray</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">        longitudes in degrees</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">    alt : float or ndarray</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">        altitude above surrounding terrain that defines the horizon, meters</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">    datetimeUTC : pandas.Timestamp, datetime, or str</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">        date and time in UTC</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">    refraction : bool, optional (default=False)</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">        specifies whether to account for atmospheric refraction</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">    temperature : float or ndarray, optional (default=10)</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">        surface atmospheric temperature (Celsius), only used for refraction calculation</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">    pressure : float or ndarray, optional (default=101325)</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">        surface atmospheric pressure (Pa), only used for refraction calculation</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">    </span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">    Returns</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">    -------</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">    sea : float or ndarray</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">        solar elevation angle in degrees at the designated locations and times</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">        If refraction=False, this is the true solar elevation angle</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">        If refraction=True, this is the apparent solar elevation angle</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">    </span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>    <span class="k">if</span> <span class="n">refraction</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">alt</span><span class="p">):</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span> <span class="s1">&#39;Atmospheric refraction is calculated for surface conditions, &#39;</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>                    <span class="o">+</span> <span class="s1">&#39;but an altitude above the surface was specified&#39;</span><span class="p">,</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>                     <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>                     <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span> <span class="p">)</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>    <span class="n">sea</span> <span class="o">=</span> <span class="n">horizon_zenith_angle</span><span class="p">(</span> <span class="n">alt</span> <span class="p">)</span> \
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>         <span class="o">-</span> <span class="n">solar_zenith_angle</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span><span class="p">,</span> <span class="n">refraction</span><span class="p">,</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">pressure</span> <span class="p">)</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>    <span class="k">return</span> <span class="n">sea</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="k">def</span> <span class="nf">solar_zenith_angle</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span><span class="p">,</span> 
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>                       <span class="n">refraction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="mf">101325.</span> <span class="p">):</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Solar zenith angle (degrees) for a given latitude, longitude, date and time.</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">    </span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">    Accounts for equation of time and (optionally) for atmospheric refraction.</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="sd">    Altitude of the observer is not accounted for, which can be important when the sun </span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">    is near the horizon. </span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">    </span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">    Results are accurate to tenths of a degree, except where altitude is important</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="sd">    (&lt; 20 degrees solar elevation)</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">    Parameters</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">    ----------</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">    lat : float or ndarray</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">        latitude in degrees</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">    lon : float or ndarray</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="sd">        longitudes in degrees</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">    datetimeUTC : pandas.Timestamp, datetime, or str</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">        date and time in UTC</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="sd">    refraction : bool, optional (default=False)</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">        specifies whether to account for atmospheric refraction</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">    temperature : float or ndarray, optional (default=10)</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="sd">        surface atmospheric temperature (Celsius), only used for refraction calculation</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="sd">    pressure : float or ndarray, optional (default=101325)</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="sd">        surface atmospheric pressure (Pa), only used for refraction calculation</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">    </span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">    Returns</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">    -------</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">    sza : float or ndarray</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="sd">        solar zenith angle in degrees at the designated locations and times</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">        If refraction=False, this is the true solar zenith angle</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">        If refraction=True, this is the apparent solar zenith angle</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>    <span class="c1"># Convert to pandas Timestamp, if needed</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>    <span class="n">datetimeUTC</span> <span class="o">=</span> <span class="n">_to_timestamp</span><span class="p">(</span><span class="n">datetimeUTC</span><span class="p">)</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>    <span class="c1"># Solar declination, degrees</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>    <span class="n">dec</span> <span class="o">=</span> <span class="n">solar_declination</span><span class="p">(</span> <span class="n">datetimeUTC</span> <span class="p">)</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>    <span class="c1"># Hour angle, degrees</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>    <span class="n">Ha</span> <span class="o">=</span> <span class="n">solar_hour_angle</span><span class="p">(</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span> <span class="p">)</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>    <span class="c1"># True solar zenith angle, radians</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>    <span class="n">sza</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dec</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="o">+</span> \
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>          <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dec</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Ha</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="p">)</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>    <span class="c1"># Convert radians -&gt; degrees</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>    <span class="n">sza</span> <span class="o">/=</span> <span class="n">pi180</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>    <span class="k">if</span> <span class="n">refraction</span><span class="p">:</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>        <span class="c1"># Subtract refraction angle (degrees) from zenith angle.</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>        <span class="c1"># SZA is always smaller due to refraction.</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>        <span class="n">sza</span> <span class="o">-=</span> <span class="n">refraction_angle</span><span class="p">(</span> <span class="mi">90</span><span class="o">-</span><span class="n">sza</span><span class="p">,</span> <span class="n">pressure</span><span class="p">,</span> <span class="n">temperature</span> <span class="p">)</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>    <span class="k">return</span> <span class="n">sza</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="k">def</span> <span class="nf">equation_of_time</span><span class="p">(</span> <span class="n">date</span> <span class="p">):</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Equation of time (degrees) for specified date</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">    </span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">    Implements the &quot;alternative equation&quot; from Wikipedia, derived from</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">    https://web.archive.org/web/20120323231813/http://www.green-life-innovators.org/tiki-index.php?page=The%2BLatitude%2Band%2BLongitude%2Bof%2Bthe%2BSun%2Bby%2BDavid%2BWilliams</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">    Results checked against NOAA solar calculator and agree within 10 seconds.</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">    </span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">    Argument</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="sd">    --------</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="sd">    date : pandas.Timestamp, date, or datetime</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="sd">        date for calculation</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="sd">    Returns</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a><span class="sd">    -------</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a><span class="sd">    eot : float</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a><span class="sd">        equation of time in degrees on the specified date</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>    <span class="c1"># Convert to pandas Timestamp, if needed</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>    <span class="n">date</span> <span class="o">=</span> <span class="n">_to_timestamp</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>    <span class="c1"># Equation of time, accounts for the solar day differing slightly from 24 hr</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>    <span class="n">doy</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">dayofyear</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>    <span class="n">W</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">/</span> <span class="mf">365.24</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>    <span class="n">A</span> <span class="o">=</span> <span class="n">W</span> <span class="o">*</span> <span class="p">(</span><span class="n">doy</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>    <span class="n">B</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="mf">1.914</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">W</span> <span class="o">*</span> <span class="p">(</span><span class="n">doy</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>    <span class="n">C</span> <span class="o">=</span> <span class="p">(</span> <span class="n">A</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">B</span><span class="o">*</span><span class="n">pi180</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">23.44</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">pi180</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">180</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>    <span class="c1"># Equation of time in minutes of an hour</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>    <span class="n">eotmin</span> <span class="o">=</span> <span class="mi">720</span> <span class="o">*</span> <span class="p">(</span> <span class="n">C</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="p">)</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>    <span class="c1"># Equation of time, minutes -&gt; degrees</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>    <span class="n">eot</span> <span class="o">=</span> <span class="n">eotmin</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">/</span> <span class="mi">24</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>    <span class="k">return</span> <span class="n">eot</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a><span class="k">def</span> <span class="nf">horizon_zenith_angle</span><span class="p">(</span> <span class="n">alt</span> <span class="p">):</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Angle from the zenith to the horizon</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a><span class="sd">    </span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a><span class="sd">    The horizon is the locii of points where a line from the </span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a><span class="sd">    observation location to the ellipsoid is tangent to the ellipsoid surface.</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a><span class="sd">    </span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="sd">    The altitude parameter should be the vertical distance </span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a><span class="sd">    above the surrounding terrain that defines the horizon,</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="sd">    not necessarily the altitude above sea level or the altitude above ground level.</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a><span class="sd">    For example, on a mountain peak that is 4000 m above sea level and </span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="sd">    1500 m above the surrounding plateau, the relevant altitude is 1500 m.</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a><span class="sd">    For an observer on the plateau, the relevant altitude is 0 m.</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="sd">    The implementation below assumes a spherical Earth.</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="sd">    Results using the WGS84 ellipsoid (see commented code below)</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a><span class="sd">    differ from the spherical case by &lt;&lt; 1°. Terrain,</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="sd">    which is neglected here, has a larger effect on the horizon</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">    location, so the simpler spherical calculation is appropriate. </span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a><span class="sd">    Parameters</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a><span class="sd">    ----------</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a><span class="sd">    lat : float or ndarray</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a><span class="sd">        latitude in degrees</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a><span class="sd">    alt : float or ndarray</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a><span class="sd">        altitude above surrounding terrain that defines the horizon, meters</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a><span class="sd">        </span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a><span class="sd">    Returns</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a><span class="sd">    -------</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a><span class="sd">    hza : float or ndarray</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a><span class="sd">        horizon zenith angle in degrees</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>    <span class="c1"># WGS84 ellipsoid parameters</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>    <span class="c1"># semi-major radius, m</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>    <span class="n">r_earth</span> <span class="o">=</span> <span class="mf">6378137.0</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>    <span class="c1"># ellipsoidal flattening, unitless</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>    <span class="n">f</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">298.257223563</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>    <span class="c1"># Horizon zenith angle, degrees (spherical earth)</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>    <span class="n">hza</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span> <span class="n">r_earth</span> <span class="o">/</span> <span class="p">(</span> <span class="n">r_earth</span> <span class="o">+</span> <span class="n">alt</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">pi180</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>    <span class="c1">## Ellipsoidal Earth</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>    <span class="c1"># # Eccentricity of ellipsoid</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>    <span class="c1"># ecc = f * (2-f)</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>    <span class="c1"># # Local (i.e. prime vertical) radius of curvature at latitude</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>    <span class="c1"># N = r_earth / np.sqrt( 1 - ecc**2 * np.sin(lat*pi180)**2 )</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>    <span class="c1"># # Horizon zenith angle, degrees</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>    <span class="c1"># hza = 180 - np.arcsin( N / (N+alt) ) / pi180</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>    <span class="k">return</span> <span class="n">hza</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="k">def</span> <span class="nf">solar_declination</span><span class="p">(</span> <span class="n">date</span> <span class="p">):</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Calculate solar declination (degrees) for specified date</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">    </span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">    Implements Eq. 9.68-9.72 from M.Z. Jacobson, Fundamentals of Atmospheric Modeling</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="sd">    </span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a><span class="sd">    Argument</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a><span class="sd">    --------</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a><span class="sd">    date : pandas.Timestamp, date, datetime, or str</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="sd">        date for calculation</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="sd">    Returns</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="sd">    -------</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="sd">    dec : float</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a><span class="sd">        solar declination in degrees at the specified date</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>    <span class="c1"># Convert to pandas Timestamp, if needed</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>    <span class="n">date</span> <span class="o">=</span> <span class="n">_to_timestamp</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>     <span class="c1"># Number of days since beginning of 2000</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>    <span class="n">NJD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span> <span class="n">date</span><span class="o">.</span><span class="n">to_julian_date</span><span class="p">()</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_julian_date</span><span class="p">()</span> <span class="p">)</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>    <span class="c1"># Obliquity, degrees</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>    <span class="n">ob</span> <span class="o">=</span> <span class="mf">23.439</span> <span class="o">-</span> <span class="mf">4e-7</span> <span class="o">*</span> <span class="n">NJD</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>    <span class="c1"># Parameters for ecliptic, degrees</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>    <span class="n">gm</span> <span class="o">=</span> <span class="mf">357.528</span> <span class="o">+</span> <span class="mf">0.9856003</span> <span class="o">*</span> <span class="n">NJD</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>    <span class="n">lm</span> <span class="o">=</span> <span class="mf">280.460</span> <span class="o">+</span> <span class="mf">0.9856474</span> <span class="o">*</span> <span class="n">NJD</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>    <span class="c1"># Ecliptic longitude of sun, degrees</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>    <span class="n">ec</span> <span class="o">=</span> <span class="n">lm</span> <span class="o">+</span> <span class="mf">1.915</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">gm</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span> <span class="o">+</span> <span class="mf">0.020</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gm</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>    <span class="c1">#Solar declination, degrees</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>    <span class="n">dec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">ob</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">ec</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">pi180</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>    <span class="k">return</span> <span class="n">dec</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a><span class="k">def</span> <span class="nf">solar_hour_angle</span><span class="p">(</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span> <span class="p">):</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Solar hour angle (degrees) for specified longitude, date and time</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a><span class="sd">    Hour angle is the angular displacement of the sun from the local meridian.</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a><span class="sd">    It is zero at local noon, negative in the morning, and positive is afternoon.</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a><span class="sd">    </span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="sd">    Parameters</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="sd">    ----------</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="sd">    lon : float</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="sd">        longitude in degrees east</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">    datetimeUTC : pandas.Timestamp or datetime</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">        date and time for calculation, must be UTC</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">    </span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="sd">    Returns</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">    -------</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="sd">    ha : float</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a><span class="sd">        hour angle in degrees at the specified location and time</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>    <span class="c1"># Convert to pandas Timestamp, if needed</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>    <span class="n">datetimeUTC</span> <span class="o">=</span> <span class="n">_to_timestamp</span><span class="p">(</span><span class="n">datetimeUTC</span><span class="p">)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>    <span class="c1"># Hour angle for mean solar time.</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>    <span class="c1"># Actual solar position has a small offset given by the equation of time (below)</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>    <span class="n">Ha</span> <span class="o">=</span> <span class="p">(</span> <span class="n">datetimeUTC</span><span class="o">.</span><span class="n">hour</span> <span class="o">+</span> <span class="n">datetimeUTC</span><span class="o">.</span><span class="n">minute</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">-</span> <span class="mi">12</span> <span class="p">)</span> <span class="o">*</span> <span class="mi">15</span> <span class="o">+</span> <span class="n">lon</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>    <span class="c1"># Add equation of time to the hour angle, degrees</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>    <span class="n">Ha</span> <span class="o">+=</span> <span class="n">equation_of_time</span><span class="p">(</span> <span class="n">datetimeUTC</span> <span class="p">)</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>    <span class="k">return</span> <span class="n">Ha</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a><span class="k">def</span> <span class="nf">refraction_angle</span><span class="p">(</span> <span class="n">true_elevation_angle</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="mf">101325.</span><span class="p">,</span> <span class="n">temperature_celsius</span><span class="o">=</span><span class="mf">10.</span> <span class="p">):</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Atmospheric refraction angle for light passing through Earth&#39;s atmosphere</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a><span class="sd">    The apparent locations in the sky of objects outsides Earth&#39;s atmosphere </span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="sd">    differs from their true locations due to atmospheric refraction. </span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="sd">    (e.g. sun and moon when they rise and set)</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="sd">    The apparent elevation of an object above the horizon is</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a><span class="sd">    apparent elevation angle = (true elevation angle) + (refraction angle)</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="sd">    </span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="sd">    The equations here are from Saemundsson/Bennett, whose calculations use</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a><span class="sd">    a typical vertical profile of atmospheric density (i.e. temperature and pressure).</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a><span class="sd">    The profiles can be rescaled to a particular surface temperature and pressure</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a><span class="sd">    to approximately account for varying atmospheric conditions.</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a><span class="sd">    Accurate refraction calculations should use fully specified vertical profile</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a><span class="sd">    of temperature and pressure, which cannot be done here.</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a><span class="sd">    Parameters</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a><span class="sd">    ----------</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a><span class="sd">    true_elevation_angle : float</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a><span class="sd">        degrees above horizon of sun or other object</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a><span class="sd">    pressure : float (default=101325)</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a><span class="sd">        surface atmospheric pressure (Pa)</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a><span class="sd">    temperature_celsius : float (default=10)</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a><span class="sd">        surface atmospheric temperature (C)</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a><span class="sd">    Returns</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a><span class="sd">    -------</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a><span class="sd">    angle : float</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a><span class="sd">        refraction angle in degrees. Value is zero when apparent elevation is below horizon</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>    <span class="c1"># Refraction angle, arcminutes</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>    <span class="n">R</span> <span class="o">=</span> <span class="mf">1.02</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span> <span class="p">(</span> <span class="n">true_elevation_angle</span> <span class="o">+</span> <span class="mf">10.3</span> <span class="o">/</span> <span class="p">(</span><span class="n">true_elevation_angle</span> <span class="o">+</span> <span class="mf">5.11</span><span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>    <span class="c1"># Account for temperature and pressure, arcminutes</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>    <span class="n">R</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">pressure</span> <span class="o">/</span> <span class="mi">101325</span> <span class="o">*</span> <span class="mi">283</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">273</span> <span class="o">+</span> <span class="n">temperature_celsius</span> <span class="p">)</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>    <span class="c1"># Convert arcminutes -&gt; degrees</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>    <span class="n">R</span> <span class="o">/=</span> <span class="mi">60</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>    <span class="c1"># Result must be positive</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>    <span class="c1"># Refraction defined only when the apparent elevation angle is positive</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>    <span class="c1"># Set refraction to zero when the apparent elevation is below horizon</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>    <span class="n">refraction_angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span> <span class="n">true_elevation_angle</span> <span class="o">+</span> <span class="n">R</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>    <span class="k">return</span> <span class="n">refraction_angle</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a><span class="k">def</span> <span class="nf">_to_timestamp</span><span class="p">(</span><span class="n">time_in</span><span class="p">):</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Convert input to Pandas Timestamp or DatetimeIndex</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a><span class="sd">    </span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a><span class="sd">    Arguments</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a><span class="sd">    ---------</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a><span class="sd">    time_in : datetime-like or array</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a><span class="sd">        time to be converted</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a><span class="sd">    Returns</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">    -------</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a><span class="sd">    time_out : pandas.DatetimeIndex or pandas.Timestamp</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="sd">        result will be a DatetimeIndex, if possible, and Timestamp otherwise</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_in</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span> <span class="p">):</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>            <span class="n">time_out</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">time_in</span><span class="p">)</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>            <span class="n">time_in</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">time_in</span><span class="p">)</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>        <span class="n">time_out</span> <span class="o">=</span> <span class="n">time_in</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>    <span class="k">return</span> <span class="n">time_out</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="c1"># Aliases for functions</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="n">sza</span> <span class="o">=</span> <span class="n">solar_zenith_angle</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="n">saa</span> <span class="o">=</span> <span class="n">solar_azimuth_angle</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="n">sea</span> <span class="o">=</span> <span class="n">solar_elevation_angle</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="c1"># Additional aliases for backwards compatibility</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="n">equationOfTime</span> <span class="o">=</span> <span class="n">equation_of_time</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="n">solarDeclination</span> <span class="o">=</span> <span class="n">solar_declination</span>
</span></pre></div>


            </section>
                <section id="pi180">
                    <div class="attr variable">
            <span class="name">pi180</span>        =
<span class="default_value">0.017453292519943295</span>

        
    </div>
    <a class="headerlink" href="#pi180"></a>
    
    

                </section>
                <section id="solar_azimuth_angle">
                            <input id="solar_azimuth_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">solar_azimuth_angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">lat</span>, </span><span class="param"><span class="n">lon</span>, </span><span class="param"><span class="n">datetimeUTC</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="solar_azimuth_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#solar_azimuth_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="solar_azimuth_angle-16"><a href="#solar_azimuth_angle-16"><span class="linenos">16</span></a><span class="k">def</span> <span class="nf">solar_azimuth_angle</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span> <span class="p">):</span>
</span><span id="solar_azimuth_angle-17"><a href="#solar_azimuth_angle-17"><span class="linenos">17</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Solar azimuth angle (degrees) for a latitude, longitude, date and time</span>
</span><span id="solar_azimuth_angle-18"><a href="#solar_azimuth_angle-18"><span class="linenos">18</span></a><span class="sd">    </span>
</span><span id="solar_azimuth_angle-19"><a href="#solar_azimuth_angle-19"><span class="linenos">19</span></a><span class="sd">    SAA is degrees clockwise from north.</span>
</span><span id="solar_azimuth_angle-20"><a href="#solar_azimuth_angle-20"><span class="linenos">20</span></a><span class="sd">    </span>
</span><span id="solar_azimuth_angle-21"><a href="#solar_azimuth_angle-21"><span class="linenos">21</span></a><span class="sd">    Parameters</span>
</span><span id="solar_azimuth_angle-22"><a href="#solar_azimuth_angle-22"><span class="linenos">22</span></a><span class="sd">    ----------</span>
</span><span id="solar_azimuth_angle-23"><a href="#solar_azimuth_angle-23"><span class="linenos">23</span></a><span class="sd">    lat : float or ndarray</span>
</span><span id="solar_azimuth_angle-24"><a href="#solar_azimuth_angle-24"><span class="linenos">24</span></a><span class="sd">        latitude in degrees</span>
</span><span id="solar_azimuth_angle-25"><a href="#solar_azimuth_angle-25"><span class="linenos">25</span></a><span class="sd">    lon : float or ndarray</span>
</span><span id="solar_azimuth_angle-26"><a href="#solar_azimuth_angle-26"><span class="linenos">26</span></a><span class="sd">        longitudes in degrees</span>
</span><span id="solar_azimuth_angle-27"><a href="#solar_azimuth_angle-27"><span class="linenos">27</span></a><span class="sd">    datetimeUTC : pandas.Timestamp, datetime, or str</span>
</span><span id="solar_azimuth_angle-28"><a href="#solar_azimuth_angle-28"><span class="linenos">28</span></a><span class="sd">        date and time in UTC</span>
</span><span id="solar_azimuth_angle-29"><a href="#solar_azimuth_angle-29"><span class="linenos">29</span></a>
</span><span id="solar_azimuth_angle-30"><a href="#solar_azimuth_angle-30"><span class="linenos">30</span></a><span class="sd">    Returns</span>
</span><span id="solar_azimuth_angle-31"><a href="#solar_azimuth_angle-31"><span class="linenos">31</span></a><span class="sd">    -------</span>
</span><span id="solar_azimuth_angle-32"><a href="#solar_azimuth_angle-32"><span class="linenos">32</span></a><span class="sd">    saa : float or ndarray</span>
</span><span id="solar_azimuth_angle-33"><a href="#solar_azimuth_angle-33"><span class="linenos">33</span></a><span class="sd">        solar azimuth angle in degrees (clockwise from north)</span>
</span><span id="solar_azimuth_angle-34"><a href="#solar_azimuth_angle-34"><span class="linenos">34</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="solar_azimuth_angle-35"><a href="#solar_azimuth_angle-35"><span class="linenos">35</span></a>    <span class="c1"># Convert to pandas Timestamp, if needed</span>
</span><span id="solar_azimuth_angle-36"><a href="#solar_azimuth_angle-36"><span class="linenos">36</span></a>    <span class="n">datetimeUTC</span> <span class="o">=</span> <span class="n">_to_timestamp</span><span class="p">(</span><span class="n">datetimeUTC</span><span class="p">)</span>
</span><span id="solar_azimuth_angle-37"><a href="#solar_azimuth_angle-37"><span class="linenos">37</span></a>
</span><span id="solar_azimuth_angle-38"><a href="#solar_azimuth_angle-38"><span class="linenos">38</span></a>    <span class="c1"># Solar declination, degrees</span>
</span><span id="solar_azimuth_angle-39"><a href="#solar_azimuth_angle-39"><span class="linenos">39</span></a>    <span class="n">dec</span> <span class="o">=</span> <span class="n">solar_declination</span><span class="p">(</span> <span class="n">datetimeUTC</span> <span class="p">)</span>
</span><span id="solar_azimuth_angle-40"><a href="#solar_azimuth_angle-40"><span class="linenos">40</span></a>
</span><span id="solar_azimuth_angle-41"><a href="#solar_azimuth_angle-41"><span class="linenos">41</span></a>    <span class="c1"># Hour angle, degrees</span>
</span><span id="solar_azimuth_angle-42"><a href="#solar_azimuth_angle-42"><span class="linenos">42</span></a>    <span class="n">Ha</span> <span class="o">=</span> <span class="n">solar_hour_angle</span><span class="p">(</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span> <span class="p">)</span>
</span><span id="solar_azimuth_angle-43"><a href="#solar_azimuth_angle-43"><span class="linenos">43</span></a>
</span><span id="solar_azimuth_angle-44"><a href="#solar_azimuth_angle-44"><span class="linenos">44</span></a>    <span class="c1"># Solar zenith angle, degrees</span>
</span><span id="solar_azimuth_angle-45"><a href="#solar_azimuth_angle-45"><span class="linenos">45</span></a>    <span class="c1"># Use true sza, without refraction</span>
</span><span id="solar_azimuth_angle-46"><a href="#solar_azimuth_angle-46"><span class="linenos">46</span></a>    <span class="n">zen</span> <span class="o">=</span> <span class="n">sza</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span><span class="p">,</span> <span class="n">refraction</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>
</span><span id="solar_azimuth_angle-47"><a href="#solar_azimuth_angle-47"><span class="linenos">47</span></a>
</span><span id="solar_azimuth_angle-48"><a href="#solar_azimuth_angle-48"><span class="linenos">48</span></a>    <span class="c1"># Solar azimuth angle, degrees</span>
</span><span id="solar_azimuth_angle-49"><a href="#solar_azimuth_angle-49"><span class="linenos">49</span></a>    <span class="n">saa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">Ha</span><span class="o">*</span><span class="n">pi180</span> <span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span> <span class="n">dec</span><span class="o">*</span><span class="n">pi180</span> <span class="p">)</span> <span class="o">/</span>
</span><span id="solar_azimuth_angle-50"><a href="#solar_azimuth_angle-50"><span class="linenos">50</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">zen</span><span class="o">*</span><span class="n">pi180</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">pi180</span>
</span><span id="solar_azimuth_angle-51"><a href="#solar_azimuth_angle-51"><span class="linenos">51</span></a>
</span><span id="solar_azimuth_angle-52"><a href="#solar_azimuth_angle-52"><span class="linenos">52</span></a>    <span class="c1"># Change range [-180,180] to [0,360]</span>
</span><span id="solar_azimuth_angle-53"><a href="#solar_azimuth_angle-53"><span class="linenos">53</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span> <span class="n">saa</span><span class="o">+</span><span class="mi">360</span><span class="p">,</span> <span class="mi">360</span> <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Solar azimuth angle (degrees) for a latitude, longitude, date and time</p>

<p>SAA is degrees clockwise from north.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>lat</strong> (float or ndarray):
latitude in degrees</li>
<li><strong>lon</strong> (float or ndarray):
longitudes in degrees</li>
<li><strong>datetimeUTC</strong> (pandas.Timestamp, datetime, or str):
date and time in UTC</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>saa</strong> (float or ndarray):
solar azimuth angle in degrees (clockwise from north)</li>
</ul>
</div>


                </section>
                <section id="solar_elevation_angle">
                            <input id="solar_elevation_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">solar_elevation_angle</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">lat</span>,</span><span class="param">	<span class="n">lon</span>,</span><span class="param">	<span class="n">alt</span>,</span><span class="param">	<span class="n">datetimeUTC</span>,</span><span class="param">	<span class="n">refraction</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">temperature</span><span class="o">=</span><span class="mf">10.0</span>,</span><span class="param">	<span class="n">pressure</span><span class="o">=</span><span class="mf">101325.0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="solar_elevation_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#solar_elevation_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="solar_elevation_angle-55"><a href="#solar_elevation_angle-55"><span class="linenos"> 55</span></a><span class="k">def</span> <span class="nf">solar_elevation_angle</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">datetimeUTC</span><span class="p">,</span>
</span><span id="solar_elevation_angle-56"><a href="#solar_elevation_angle-56"><span class="linenos"> 56</span></a>                       <span class="n">refraction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="mf">101325.</span> <span class="p">):</span>
</span><span id="solar_elevation_angle-57"><a href="#solar_elevation_angle-57"><span class="linenos"> 57</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Solar elevation angle (degrees) above the horizon</span>
</span><span id="solar_elevation_angle-58"><a href="#solar_elevation_angle-58"><span class="linenos"> 58</span></a>
</span><span id="solar_elevation_angle-59"><a href="#solar_elevation_angle-59"><span class="linenos"> 59</span></a><span class="sd">    The altitude parameter should be the vertical distance </span>
</span><span id="solar_elevation_angle-60"><a href="#solar_elevation_angle-60"><span class="linenos"> 60</span></a><span class="sd">    above the surrounding terrain that defines the horizon,</span>
</span><span id="solar_elevation_angle-61"><a href="#solar_elevation_angle-61"><span class="linenos"> 61</span></a><span class="sd">    not necessarily the altitude above sea level or the altitude above ground level.</span>
</span><span id="solar_elevation_angle-62"><a href="#solar_elevation_angle-62"><span class="linenos"> 62</span></a><span class="sd">    For example, on a mountain peak that is 4000 m above sea level and </span>
</span><span id="solar_elevation_angle-63"><a href="#solar_elevation_angle-63"><span class="linenos"> 63</span></a><span class="sd">    1500 m above the surrounding plateau, the relevant altitude is 1500 m.</span>
</span><span id="solar_elevation_angle-64"><a href="#solar_elevation_angle-64"><span class="linenos"> 64</span></a><span class="sd">    For an observer on the plateau, the relevant altitude is 0 m.</span>
</span><span id="solar_elevation_angle-65"><a href="#solar_elevation_angle-65"><span class="linenos"> 65</span></a>
</span><span id="solar_elevation_angle-66"><a href="#solar_elevation_angle-66"><span class="linenos"> 66</span></a><span class="sd">    See documentation for `solar_zenith_angle` and `horizon_zenith_angle`.</span>
</span><span id="solar_elevation_angle-67"><a href="#solar_elevation_angle-67"><span class="linenos"> 67</span></a>
</span><span id="solar_elevation_angle-68"><a href="#solar_elevation_angle-68"><span class="linenos"> 68</span></a><span class="sd">    Parameters</span>
</span><span id="solar_elevation_angle-69"><a href="#solar_elevation_angle-69"><span class="linenos"> 69</span></a><span class="sd">    ----------</span>
</span><span id="solar_elevation_angle-70"><a href="#solar_elevation_angle-70"><span class="linenos"> 70</span></a><span class="sd">    lat : float or ndarray</span>
</span><span id="solar_elevation_angle-71"><a href="#solar_elevation_angle-71"><span class="linenos"> 71</span></a><span class="sd">        latitude in degrees</span>
</span><span id="solar_elevation_angle-72"><a href="#solar_elevation_angle-72"><span class="linenos"> 72</span></a><span class="sd">    lon : float or ndarray</span>
</span><span id="solar_elevation_angle-73"><a href="#solar_elevation_angle-73"><span class="linenos"> 73</span></a><span class="sd">        longitudes in degrees</span>
</span><span id="solar_elevation_angle-74"><a href="#solar_elevation_angle-74"><span class="linenos"> 74</span></a><span class="sd">    alt : float or ndarray</span>
</span><span id="solar_elevation_angle-75"><a href="#solar_elevation_angle-75"><span class="linenos"> 75</span></a><span class="sd">        altitude above surrounding terrain that defines the horizon, meters</span>
</span><span id="solar_elevation_angle-76"><a href="#solar_elevation_angle-76"><span class="linenos"> 76</span></a><span class="sd">    datetimeUTC : pandas.Timestamp, datetime, or str</span>
</span><span id="solar_elevation_angle-77"><a href="#solar_elevation_angle-77"><span class="linenos"> 77</span></a><span class="sd">        date and time in UTC</span>
</span><span id="solar_elevation_angle-78"><a href="#solar_elevation_angle-78"><span class="linenos"> 78</span></a><span class="sd">    refraction : bool, optional (default=False)</span>
</span><span id="solar_elevation_angle-79"><a href="#solar_elevation_angle-79"><span class="linenos"> 79</span></a><span class="sd">        specifies whether to account for atmospheric refraction</span>
</span><span id="solar_elevation_angle-80"><a href="#solar_elevation_angle-80"><span class="linenos"> 80</span></a><span class="sd">    temperature : float or ndarray, optional (default=10)</span>
</span><span id="solar_elevation_angle-81"><a href="#solar_elevation_angle-81"><span class="linenos"> 81</span></a><span class="sd">        surface atmospheric temperature (Celsius), only used for refraction calculation</span>
</span><span id="solar_elevation_angle-82"><a href="#solar_elevation_angle-82"><span class="linenos"> 82</span></a><span class="sd">    pressure : float or ndarray, optional (default=101325)</span>
</span><span id="solar_elevation_angle-83"><a href="#solar_elevation_angle-83"><span class="linenos"> 83</span></a><span class="sd">        surface atmospheric pressure (Pa), only used for refraction calculation</span>
</span><span id="solar_elevation_angle-84"><a href="#solar_elevation_angle-84"><span class="linenos"> 84</span></a><span class="sd">    </span>
</span><span id="solar_elevation_angle-85"><a href="#solar_elevation_angle-85"><span class="linenos"> 85</span></a><span class="sd">    Returns</span>
</span><span id="solar_elevation_angle-86"><a href="#solar_elevation_angle-86"><span class="linenos"> 86</span></a><span class="sd">    -------</span>
</span><span id="solar_elevation_angle-87"><a href="#solar_elevation_angle-87"><span class="linenos"> 87</span></a><span class="sd">    sea : float or ndarray</span>
</span><span id="solar_elevation_angle-88"><a href="#solar_elevation_angle-88"><span class="linenos"> 88</span></a><span class="sd">        solar elevation angle in degrees at the designated locations and times</span>
</span><span id="solar_elevation_angle-89"><a href="#solar_elevation_angle-89"><span class="linenos"> 89</span></a><span class="sd">        If refraction=False, this is the true solar elevation angle</span>
</span><span id="solar_elevation_angle-90"><a href="#solar_elevation_angle-90"><span class="linenos"> 90</span></a><span class="sd">        If refraction=True, this is the apparent solar elevation angle</span>
</span><span id="solar_elevation_angle-91"><a href="#solar_elevation_angle-91"><span class="linenos"> 91</span></a><span class="sd">    </span>
</span><span id="solar_elevation_angle-92"><a href="#solar_elevation_angle-92"><span class="linenos"> 92</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="solar_elevation_angle-93"><a href="#solar_elevation_angle-93"><span class="linenos"> 93</span></a>
</span><span id="solar_elevation_angle-94"><a href="#solar_elevation_angle-94"><span class="linenos"> 94</span></a>    <span class="k">if</span> <span class="n">refraction</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">alt</span><span class="p">):</span>
</span><span id="solar_elevation_angle-95"><a href="#solar_elevation_angle-95"><span class="linenos"> 95</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span> <span class="s1">&#39;Atmospheric refraction is calculated for surface conditions, &#39;</span>
</span><span id="solar_elevation_angle-96"><a href="#solar_elevation_angle-96"><span class="linenos"> 96</span></a>                    <span class="o">+</span> <span class="s1">&#39;but an altitude above the surface was specified&#39;</span><span class="p">,</span>
</span><span id="solar_elevation_angle-97"><a href="#solar_elevation_angle-97"><span class="linenos"> 97</span></a>                     <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
</span><span id="solar_elevation_angle-98"><a href="#solar_elevation_angle-98"><span class="linenos"> 98</span></a>                     <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span> <span class="p">)</span>
</span><span id="solar_elevation_angle-99"><a href="#solar_elevation_angle-99"><span class="linenos"> 99</span></a>
</span><span id="solar_elevation_angle-100"><a href="#solar_elevation_angle-100"><span class="linenos">100</span></a>    <span class="n">sea</span> <span class="o">=</span> <span class="n">horizon_zenith_angle</span><span class="p">(</span> <span class="n">alt</span> <span class="p">)</span> \
</span><span id="solar_elevation_angle-101"><a href="#solar_elevation_angle-101"><span class="linenos">101</span></a>         <span class="o">-</span> <span class="n">solar_zenith_angle</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span><span class="p">,</span> <span class="n">refraction</span><span class="p">,</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">pressure</span> <span class="p">)</span>
</span><span id="solar_elevation_angle-102"><a href="#solar_elevation_angle-102"><span class="linenos">102</span></a>
</span><span id="solar_elevation_angle-103"><a href="#solar_elevation_angle-103"><span class="linenos">103</span></a>    <span class="k">return</span> <span class="n">sea</span>
</span></pre></div>


            <div class="docstring"><p>Solar elevation angle (degrees) above the horizon</p>

<p>The altitude parameter should be the vertical distance 
above the surrounding terrain that defines the horizon,
not necessarily the altitude above sea level or the altitude above ground level.
For example, on a mountain peak that is 4000 m above sea level and 
1500 m above the surrounding plateau, the relevant altitude is 1500 m.
For an observer on the plateau, the relevant altitude is 0 m.</p>

<p>See documentation for <code><a href="#solar_zenith_angle">solar_zenith_angle</a></code> and <code><a href="#horizon_zenith_angle">horizon_zenith_angle</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>lat</strong> (float or ndarray):
latitude in degrees</li>
<li><strong>lon</strong> (float or ndarray):
longitudes in degrees</li>
<li><strong>alt</strong> (float or ndarray):
altitude above surrounding terrain that defines the horizon, meters</li>
<li><strong>datetimeUTC</strong> (pandas.Timestamp, datetime, or str):
date and time in UTC</li>
<li><strong>refraction</strong> (bool, optional (default=False)):
specifies whether to account for atmospheric refraction</li>
<li><strong>temperature</strong> (float or ndarray, optional (default=10)):
surface atmospheric temperature (Celsius), only used for refraction calculation</li>
<li><strong>pressure</strong> (float or ndarray, optional (default=101325)):
surface atmospheric pressure (Pa), only used for refraction calculation</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>sea</strong> (float or ndarray):
solar elevation angle in degrees at the designated locations and times
If refraction=False, this is the true solar elevation angle
If refraction=True, this is the apparent solar elevation angle</li>
</ul>
</div>


                </section>
                <section id="solar_zenith_angle">
                            <input id="solar_zenith_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">solar_zenith_angle</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">lat</span>,</span><span class="param">	<span class="n">lon</span>,</span><span class="param">	<span class="n">datetimeUTC</span>,</span><span class="param">	<span class="n">refraction</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">temperature</span><span class="o">=</span><span class="mf">10.0</span>,</span><span class="param">	<span class="n">pressure</span><span class="o">=</span><span class="mf">101325.0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="solar_zenith_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#solar_zenith_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="solar_zenith_angle-105"><a href="#solar_zenith_angle-105"><span class="linenos">105</span></a><span class="k">def</span> <span class="nf">solar_zenith_angle</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span><span class="p">,</span> 
</span><span id="solar_zenith_angle-106"><a href="#solar_zenith_angle-106"><span class="linenos">106</span></a>                       <span class="n">refraction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="mf">101325.</span> <span class="p">):</span>
</span><span id="solar_zenith_angle-107"><a href="#solar_zenith_angle-107"><span class="linenos">107</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Solar zenith angle (degrees) for a given latitude, longitude, date and time.</span>
</span><span id="solar_zenith_angle-108"><a href="#solar_zenith_angle-108"><span class="linenos">108</span></a><span class="sd">    </span>
</span><span id="solar_zenith_angle-109"><a href="#solar_zenith_angle-109"><span class="linenos">109</span></a><span class="sd">    Accounts for equation of time and (optionally) for atmospheric refraction.</span>
</span><span id="solar_zenith_angle-110"><a href="#solar_zenith_angle-110"><span class="linenos">110</span></a><span class="sd">    Altitude of the observer is not accounted for, which can be important when the sun </span>
</span><span id="solar_zenith_angle-111"><a href="#solar_zenith_angle-111"><span class="linenos">111</span></a><span class="sd">    is near the horizon. </span>
</span><span id="solar_zenith_angle-112"><a href="#solar_zenith_angle-112"><span class="linenos">112</span></a><span class="sd">    </span>
</span><span id="solar_zenith_angle-113"><a href="#solar_zenith_angle-113"><span class="linenos">113</span></a><span class="sd">    Results are accurate to tenths of a degree, except where altitude is important</span>
</span><span id="solar_zenith_angle-114"><a href="#solar_zenith_angle-114"><span class="linenos">114</span></a><span class="sd">    (&lt; 20 degrees solar elevation)</span>
</span><span id="solar_zenith_angle-115"><a href="#solar_zenith_angle-115"><span class="linenos">115</span></a>
</span><span id="solar_zenith_angle-116"><a href="#solar_zenith_angle-116"><span class="linenos">116</span></a><span class="sd">    Parameters</span>
</span><span id="solar_zenith_angle-117"><a href="#solar_zenith_angle-117"><span class="linenos">117</span></a><span class="sd">    ----------</span>
</span><span id="solar_zenith_angle-118"><a href="#solar_zenith_angle-118"><span class="linenos">118</span></a><span class="sd">    lat : float or ndarray</span>
</span><span id="solar_zenith_angle-119"><a href="#solar_zenith_angle-119"><span class="linenos">119</span></a><span class="sd">        latitude in degrees</span>
</span><span id="solar_zenith_angle-120"><a href="#solar_zenith_angle-120"><span class="linenos">120</span></a><span class="sd">    lon : float or ndarray</span>
</span><span id="solar_zenith_angle-121"><a href="#solar_zenith_angle-121"><span class="linenos">121</span></a><span class="sd">        longitudes in degrees</span>
</span><span id="solar_zenith_angle-122"><a href="#solar_zenith_angle-122"><span class="linenos">122</span></a><span class="sd">    datetimeUTC : pandas.Timestamp, datetime, or str</span>
</span><span id="solar_zenith_angle-123"><a href="#solar_zenith_angle-123"><span class="linenos">123</span></a><span class="sd">        date and time in UTC</span>
</span><span id="solar_zenith_angle-124"><a href="#solar_zenith_angle-124"><span class="linenos">124</span></a><span class="sd">    refraction : bool, optional (default=False)</span>
</span><span id="solar_zenith_angle-125"><a href="#solar_zenith_angle-125"><span class="linenos">125</span></a><span class="sd">        specifies whether to account for atmospheric refraction</span>
</span><span id="solar_zenith_angle-126"><a href="#solar_zenith_angle-126"><span class="linenos">126</span></a><span class="sd">    temperature : float or ndarray, optional (default=10)</span>
</span><span id="solar_zenith_angle-127"><a href="#solar_zenith_angle-127"><span class="linenos">127</span></a><span class="sd">        surface atmospheric temperature (Celsius), only used for refraction calculation</span>
</span><span id="solar_zenith_angle-128"><a href="#solar_zenith_angle-128"><span class="linenos">128</span></a><span class="sd">    pressure : float or ndarray, optional (default=101325)</span>
</span><span id="solar_zenith_angle-129"><a href="#solar_zenith_angle-129"><span class="linenos">129</span></a><span class="sd">        surface atmospheric pressure (Pa), only used for refraction calculation</span>
</span><span id="solar_zenith_angle-130"><a href="#solar_zenith_angle-130"><span class="linenos">130</span></a><span class="sd">    </span>
</span><span id="solar_zenith_angle-131"><a href="#solar_zenith_angle-131"><span class="linenos">131</span></a><span class="sd">    Returns</span>
</span><span id="solar_zenith_angle-132"><a href="#solar_zenith_angle-132"><span class="linenos">132</span></a><span class="sd">    -------</span>
</span><span id="solar_zenith_angle-133"><a href="#solar_zenith_angle-133"><span class="linenos">133</span></a><span class="sd">    sza : float or ndarray</span>
</span><span id="solar_zenith_angle-134"><a href="#solar_zenith_angle-134"><span class="linenos">134</span></a><span class="sd">        solar zenith angle in degrees at the designated locations and times</span>
</span><span id="solar_zenith_angle-135"><a href="#solar_zenith_angle-135"><span class="linenos">135</span></a><span class="sd">        If refraction=False, this is the true solar zenith angle</span>
</span><span id="solar_zenith_angle-136"><a href="#solar_zenith_angle-136"><span class="linenos">136</span></a><span class="sd">        If refraction=True, this is the apparent solar zenith angle</span>
</span><span id="solar_zenith_angle-137"><a href="#solar_zenith_angle-137"><span class="linenos">137</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="solar_zenith_angle-138"><a href="#solar_zenith_angle-138"><span class="linenos">138</span></a>    <span class="c1"># Convert to pandas Timestamp, if needed</span>
</span><span id="solar_zenith_angle-139"><a href="#solar_zenith_angle-139"><span class="linenos">139</span></a>    <span class="n">datetimeUTC</span> <span class="o">=</span> <span class="n">_to_timestamp</span><span class="p">(</span><span class="n">datetimeUTC</span><span class="p">)</span>
</span><span id="solar_zenith_angle-140"><a href="#solar_zenith_angle-140"><span class="linenos">140</span></a>
</span><span id="solar_zenith_angle-141"><a href="#solar_zenith_angle-141"><span class="linenos">141</span></a>    <span class="c1"># Solar declination, degrees</span>
</span><span id="solar_zenith_angle-142"><a href="#solar_zenith_angle-142"><span class="linenos">142</span></a>    <span class="n">dec</span> <span class="o">=</span> <span class="n">solar_declination</span><span class="p">(</span> <span class="n">datetimeUTC</span> <span class="p">)</span>
</span><span id="solar_zenith_angle-143"><a href="#solar_zenith_angle-143"><span class="linenos">143</span></a>
</span><span id="solar_zenith_angle-144"><a href="#solar_zenith_angle-144"><span class="linenos">144</span></a>    <span class="c1"># Hour angle, degrees</span>
</span><span id="solar_zenith_angle-145"><a href="#solar_zenith_angle-145"><span class="linenos">145</span></a>    <span class="n">Ha</span> <span class="o">=</span> <span class="n">solar_hour_angle</span><span class="p">(</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span> <span class="p">)</span>
</span><span id="solar_zenith_angle-146"><a href="#solar_zenith_angle-146"><span class="linenos">146</span></a>
</span><span id="solar_zenith_angle-147"><a href="#solar_zenith_angle-147"><span class="linenos">147</span></a>    <span class="c1"># True solar zenith angle, radians</span>
</span><span id="solar_zenith_angle-148"><a href="#solar_zenith_angle-148"><span class="linenos">148</span></a>    <span class="n">sza</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dec</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="o">+</span> \
</span><span id="solar_zenith_angle-149"><a href="#solar_zenith_angle-149"><span class="linenos">149</span></a>          <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dec</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Ha</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="p">)</span>
</span><span id="solar_zenith_angle-150"><a href="#solar_zenith_angle-150"><span class="linenos">150</span></a>
</span><span id="solar_zenith_angle-151"><a href="#solar_zenith_angle-151"><span class="linenos">151</span></a>    <span class="c1"># Convert radians -&gt; degrees</span>
</span><span id="solar_zenith_angle-152"><a href="#solar_zenith_angle-152"><span class="linenos">152</span></a>    <span class="n">sza</span> <span class="o">/=</span> <span class="n">pi180</span>
</span><span id="solar_zenith_angle-153"><a href="#solar_zenith_angle-153"><span class="linenos">153</span></a>
</span><span id="solar_zenith_angle-154"><a href="#solar_zenith_angle-154"><span class="linenos">154</span></a>    <span class="k">if</span> <span class="n">refraction</span><span class="p">:</span>
</span><span id="solar_zenith_angle-155"><a href="#solar_zenith_angle-155"><span class="linenos">155</span></a>        <span class="c1"># Subtract refraction angle (degrees) from zenith angle.</span>
</span><span id="solar_zenith_angle-156"><a href="#solar_zenith_angle-156"><span class="linenos">156</span></a>        <span class="c1"># SZA is always smaller due to refraction.</span>
</span><span id="solar_zenith_angle-157"><a href="#solar_zenith_angle-157"><span class="linenos">157</span></a>        <span class="n">sza</span> <span class="o">-=</span> <span class="n">refraction_angle</span><span class="p">(</span> <span class="mi">90</span><span class="o">-</span><span class="n">sza</span><span class="p">,</span> <span class="n">pressure</span><span class="p">,</span> <span class="n">temperature</span> <span class="p">)</span>
</span><span id="solar_zenith_angle-158"><a href="#solar_zenith_angle-158"><span class="linenos">158</span></a>
</span><span id="solar_zenith_angle-159"><a href="#solar_zenith_angle-159"><span class="linenos">159</span></a>    <span class="k">return</span> <span class="n">sza</span>
</span></pre></div>


            <div class="docstring"><p>Solar zenith angle (degrees) for a given latitude, longitude, date and time.</p>

<p>Accounts for equation of time and (optionally) for atmospheric refraction.
Altitude of the observer is not accounted for, which can be important when the sun 
is near the horizon. </p>

<p>Results are accurate to tenths of a degree, except where altitude is important
(&lt; 20 degrees solar elevation)</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>lat</strong> (float or ndarray):
latitude in degrees</li>
<li><strong>lon</strong> (float or ndarray):
longitudes in degrees</li>
<li><strong>datetimeUTC</strong> (pandas.Timestamp, datetime, or str):
date and time in UTC</li>
<li><strong>refraction</strong> (bool, optional (default=False)):
specifies whether to account for atmospheric refraction</li>
<li><strong>temperature</strong> (float or ndarray, optional (default=10)):
surface atmospheric temperature (Celsius), only used for refraction calculation</li>
<li><strong>pressure</strong> (float or ndarray, optional (default=101325)):
surface atmospheric pressure (Pa), only used for refraction calculation</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>sza</strong> (float or ndarray):
solar zenith angle in degrees at the designated locations and times
If refraction=False, this is the true solar zenith angle
If refraction=True, this is the apparent solar zenith angle</li>
</ul>
</div>


                </section>
                <section id="equation_of_time">
                            <input id="equation_of_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">equation_of_time</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">date</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="equation_of_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#equation_of_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="equation_of_time-161"><a href="#equation_of_time-161"><span class="linenos">161</span></a><span class="k">def</span> <span class="nf">equation_of_time</span><span class="p">(</span> <span class="n">date</span> <span class="p">):</span>
</span><span id="equation_of_time-162"><a href="#equation_of_time-162"><span class="linenos">162</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Equation of time (degrees) for specified date</span>
</span><span id="equation_of_time-163"><a href="#equation_of_time-163"><span class="linenos">163</span></a><span class="sd">    </span>
</span><span id="equation_of_time-164"><a href="#equation_of_time-164"><span class="linenos">164</span></a><span class="sd">    Implements the &quot;alternative equation&quot; from Wikipedia, derived from</span>
</span><span id="equation_of_time-165"><a href="#equation_of_time-165"><span class="linenos">165</span></a><span class="sd">    https://web.archive.org/web/20120323231813/http://www.green-life-innovators.org/tiki-index.php?page=The%2BLatitude%2Band%2BLongitude%2Bof%2Bthe%2BSun%2Bby%2BDavid%2BWilliams</span>
</span><span id="equation_of_time-166"><a href="#equation_of_time-166"><span class="linenos">166</span></a><span class="sd">    Results checked against NOAA solar calculator and agree within 10 seconds.</span>
</span><span id="equation_of_time-167"><a href="#equation_of_time-167"><span class="linenos">167</span></a><span class="sd">    </span>
</span><span id="equation_of_time-168"><a href="#equation_of_time-168"><span class="linenos">168</span></a><span class="sd">    Argument</span>
</span><span id="equation_of_time-169"><a href="#equation_of_time-169"><span class="linenos">169</span></a><span class="sd">    --------</span>
</span><span id="equation_of_time-170"><a href="#equation_of_time-170"><span class="linenos">170</span></a><span class="sd">    date : pandas.Timestamp, date, or datetime</span>
</span><span id="equation_of_time-171"><a href="#equation_of_time-171"><span class="linenos">171</span></a><span class="sd">        date for calculation</span>
</span><span id="equation_of_time-172"><a href="#equation_of_time-172"><span class="linenos">172</span></a>
</span><span id="equation_of_time-173"><a href="#equation_of_time-173"><span class="linenos">173</span></a><span class="sd">    Returns</span>
</span><span id="equation_of_time-174"><a href="#equation_of_time-174"><span class="linenos">174</span></a><span class="sd">    -------</span>
</span><span id="equation_of_time-175"><a href="#equation_of_time-175"><span class="linenos">175</span></a><span class="sd">    eot : float</span>
</span><span id="equation_of_time-176"><a href="#equation_of_time-176"><span class="linenos">176</span></a><span class="sd">        equation of time in degrees on the specified date</span>
</span><span id="equation_of_time-177"><a href="#equation_of_time-177"><span class="linenos">177</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="equation_of_time-178"><a href="#equation_of_time-178"><span class="linenos">178</span></a>    <span class="c1"># Convert to pandas Timestamp, if needed</span>
</span><span id="equation_of_time-179"><a href="#equation_of_time-179"><span class="linenos">179</span></a>    <span class="n">date</span> <span class="o">=</span> <span class="n">_to_timestamp</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
</span><span id="equation_of_time-180"><a href="#equation_of_time-180"><span class="linenos">180</span></a>
</span><span id="equation_of_time-181"><a href="#equation_of_time-181"><span class="linenos">181</span></a>    <span class="c1"># Equation of time, accounts for the solar day differing slightly from 24 hr</span>
</span><span id="equation_of_time-182"><a href="#equation_of_time-182"><span class="linenos">182</span></a>    <span class="n">doy</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">dayofyear</span>
</span><span id="equation_of_time-183"><a href="#equation_of_time-183"><span class="linenos">183</span></a>    <span class="n">W</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">/</span> <span class="mf">365.24</span>
</span><span id="equation_of_time-184"><a href="#equation_of_time-184"><span class="linenos">184</span></a>    <span class="n">A</span> <span class="o">=</span> <span class="n">W</span> <span class="o">*</span> <span class="p">(</span><span class="n">doy</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span>
</span><span id="equation_of_time-185"><a href="#equation_of_time-185"><span class="linenos">185</span></a>    <span class="n">B</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="mf">1.914</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">W</span> <span class="o">*</span> <span class="p">(</span><span class="n">doy</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span>
</span><span id="equation_of_time-186"><a href="#equation_of_time-186"><span class="linenos">186</span></a>    <span class="n">C</span> <span class="o">=</span> <span class="p">(</span> <span class="n">A</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">B</span><span class="o">*</span><span class="n">pi180</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">23.44</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">pi180</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">180</span>
</span><span id="equation_of_time-187"><a href="#equation_of_time-187"><span class="linenos">187</span></a>
</span><span id="equation_of_time-188"><a href="#equation_of_time-188"><span class="linenos">188</span></a>    <span class="c1"># Equation of time in minutes of an hour</span>
</span><span id="equation_of_time-189"><a href="#equation_of_time-189"><span class="linenos">189</span></a>    <span class="n">eotmin</span> <span class="o">=</span> <span class="mi">720</span> <span class="o">*</span> <span class="p">(</span> <span class="n">C</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="p">)</span>
</span><span id="equation_of_time-190"><a href="#equation_of_time-190"><span class="linenos">190</span></a>
</span><span id="equation_of_time-191"><a href="#equation_of_time-191"><span class="linenos">191</span></a>    <span class="c1"># Equation of time, minutes -&gt; degrees</span>
</span><span id="equation_of_time-192"><a href="#equation_of_time-192"><span class="linenos">192</span></a>    <span class="n">eot</span> <span class="o">=</span> <span class="n">eotmin</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">/</span> <span class="mi">24</span>
</span><span id="equation_of_time-193"><a href="#equation_of_time-193"><span class="linenos">193</span></a>
</span><span id="equation_of_time-194"><a href="#equation_of_time-194"><span class="linenos">194</span></a>    <span class="k">return</span> <span class="n">eot</span>
</span></pre></div>


            <div class="docstring"><p>Equation of time (degrees) for specified date</p>

<p>Implements the "alternative equation" from Wikipedia, derived from
<a href="https://web.archive.org/web/20120323231813/http://www.green-life-innovators.org/tiki-index.php?page=The%2BLatitude%2Band%2BLongitude%2Bof%2Bthe%2BSun%2Bby%2BDavid%2BWilliams">https://web.archive.org/web/20120323231813/http://www.green-life-innovators.org/tiki-index.php?page=The%2BLatitude%2Band%2BLongitude%2Bof%2Bthe%2BSun%2Bby%2BDavid%2BWilliams</a>
Results checked against NOAA solar calculator and agree within 10 seconds.</p>

<h6 id="argument">Argument</h6>

<p>date : pandas.Timestamp, date, or datetime
    date for calculation</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>eot</strong> (float):
equation of time in degrees on the specified date</li>
</ul>
</div>


                </section>
                <section id="horizon_zenith_angle">
                            <input id="horizon_zenith_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">horizon_zenith_angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">alt</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="horizon_zenith_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#horizon_zenith_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="horizon_zenith_angle-196"><a href="#horizon_zenith_angle-196"><span class="linenos">196</span></a><span class="k">def</span> <span class="nf">horizon_zenith_angle</span><span class="p">(</span> <span class="n">alt</span> <span class="p">):</span>
</span><span id="horizon_zenith_angle-197"><a href="#horizon_zenith_angle-197"><span class="linenos">197</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Angle from the zenith to the horizon</span>
</span><span id="horizon_zenith_angle-198"><a href="#horizon_zenith_angle-198"><span class="linenos">198</span></a><span class="sd">    </span>
</span><span id="horizon_zenith_angle-199"><a href="#horizon_zenith_angle-199"><span class="linenos">199</span></a><span class="sd">    The horizon is the locii of points where a line from the </span>
</span><span id="horizon_zenith_angle-200"><a href="#horizon_zenith_angle-200"><span class="linenos">200</span></a><span class="sd">    observation location to the ellipsoid is tangent to the ellipsoid surface.</span>
</span><span id="horizon_zenith_angle-201"><a href="#horizon_zenith_angle-201"><span class="linenos">201</span></a><span class="sd">    </span>
</span><span id="horizon_zenith_angle-202"><a href="#horizon_zenith_angle-202"><span class="linenos">202</span></a><span class="sd">    The altitude parameter should be the vertical distance </span>
</span><span id="horizon_zenith_angle-203"><a href="#horizon_zenith_angle-203"><span class="linenos">203</span></a><span class="sd">    above the surrounding terrain that defines the horizon,</span>
</span><span id="horizon_zenith_angle-204"><a href="#horizon_zenith_angle-204"><span class="linenos">204</span></a><span class="sd">    not necessarily the altitude above sea level or the altitude above ground level.</span>
</span><span id="horizon_zenith_angle-205"><a href="#horizon_zenith_angle-205"><span class="linenos">205</span></a><span class="sd">    For example, on a mountain peak that is 4000 m above sea level and </span>
</span><span id="horizon_zenith_angle-206"><a href="#horizon_zenith_angle-206"><span class="linenos">206</span></a><span class="sd">    1500 m above the surrounding plateau, the relevant altitude is 1500 m.</span>
</span><span id="horizon_zenith_angle-207"><a href="#horizon_zenith_angle-207"><span class="linenos">207</span></a><span class="sd">    For an observer on the plateau, the relevant altitude is 0 m.</span>
</span><span id="horizon_zenith_angle-208"><a href="#horizon_zenith_angle-208"><span class="linenos">208</span></a>
</span><span id="horizon_zenith_angle-209"><a href="#horizon_zenith_angle-209"><span class="linenos">209</span></a><span class="sd">    The implementation below assumes a spherical Earth.</span>
</span><span id="horizon_zenith_angle-210"><a href="#horizon_zenith_angle-210"><span class="linenos">210</span></a><span class="sd">    Results using the WGS84 ellipsoid (see commented code below)</span>
</span><span id="horizon_zenith_angle-211"><a href="#horizon_zenith_angle-211"><span class="linenos">211</span></a><span class="sd">    differ from the spherical case by &lt;&lt; 1°. Terrain,</span>
</span><span id="horizon_zenith_angle-212"><a href="#horizon_zenith_angle-212"><span class="linenos">212</span></a><span class="sd">    which is neglected here, has a larger effect on the horizon</span>
</span><span id="horizon_zenith_angle-213"><a href="#horizon_zenith_angle-213"><span class="linenos">213</span></a><span class="sd">    location, so the simpler spherical calculation is appropriate. </span>
</span><span id="horizon_zenith_angle-214"><a href="#horizon_zenith_angle-214"><span class="linenos">214</span></a>
</span><span id="horizon_zenith_angle-215"><a href="#horizon_zenith_angle-215"><span class="linenos">215</span></a><span class="sd">    Parameters</span>
</span><span id="horizon_zenith_angle-216"><a href="#horizon_zenith_angle-216"><span class="linenos">216</span></a><span class="sd">    ----------</span>
</span><span id="horizon_zenith_angle-217"><a href="#horizon_zenith_angle-217"><span class="linenos">217</span></a><span class="sd">    lat : float or ndarray</span>
</span><span id="horizon_zenith_angle-218"><a href="#horizon_zenith_angle-218"><span class="linenos">218</span></a><span class="sd">        latitude in degrees</span>
</span><span id="horizon_zenith_angle-219"><a href="#horizon_zenith_angle-219"><span class="linenos">219</span></a><span class="sd">    alt : float or ndarray</span>
</span><span id="horizon_zenith_angle-220"><a href="#horizon_zenith_angle-220"><span class="linenos">220</span></a><span class="sd">        altitude above surrounding terrain that defines the horizon, meters</span>
</span><span id="horizon_zenith_angle-221"><a href="#horizon_zenith_angle-221"><span class="linenos">221</span></a><span class="sd">        </span>
</span><span id="horizon_zenith_angle-222"><a href="#horizon_zenith_angle-222"><span class="linenos">222</span></a><span class="sd">    Returns</span>
</span><span id="horizon_zenith_angle-223"><a href="#horizon_zenith_angle-223"><span class="linenos">223</span></a><span class="sd">    -------</span>
</span><span id="horizon_zenith_angle-224"><a href="#horizon_zenith_angle-224"><span class="linenos">224</span></a><span class="sd">    hza : float or ndarray</span>
</span><span id="horizon_zenith_angle-225"><a href="#horizon_zenith_angle-225"><span class="linenos">225</span></a><span class="sd">        horizon zenith angle in degrees</span>
</span><span id="horizon_zenith_angle-226"><a href="#horizon_zenith_angle-226"><span class="linenos">226</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="horizon_zenith_angle-227"><a href="#horizon_zenith_angle-227"><span class="linenos">227</span></a>
</span><span id="horizon_zenith_angle-228"><a href="#horizon_zenith_angle-228"><span class="linenos">228</span></a>    <span class="c1"># WGS84 ellipsoid parameters</span>
</span><span id="horizon_zenith_angle-229"><a href="#horizon_zenith_angle-229"><span class="linenos">229</span></a>    <span class="c1"># semi-major radius, m</span>
</span><span id="horizon_zenith_angle-230"><a href="#horizon_zenith_angle-230"><span class="linenos">230</span></a>    <span class="n">r_earth</span> <span class="o">=</span> <span class="mf">6378137.0</span>
</span><span id="horizon_zenith_angle-231"><a href="#horizon_zenith_angle-231"><span class="linenos">231</span></a>    <span class="c1"># ellipsoidal flattening, unitless</span>
</span><span id="horizon_zenith_angle-232"><a href="#horizon_zenith_angle-232"><span class="linenos">232</span></a>    <span class="n">f</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">298.257223563</span>
</span><span id="horizon_zenith_angle-233"><a href="#horizon_zenith_angle-233"><span class="linenos">233</span></a>
</span><span id="horizon_zenith_angle-234"><a href="#horizon_zenith_angle-234"><span class="linenos">234</span></a>    <span class="c1"># Horizon zenith angle, degrees (spherical earth)</span>
</span><span id="horizon_zenith_angle-235"><a href="#horizon_zenith_angle-235"><span class="linenos">235</span></a>    <span class="n">hza</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span> <span class="n">r_earth</span> <span class="o">/</span> <span class="p">(</span> <span class="n">r_earth</span> <span class="o">+</span> <span class="n">alt</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">pi180</span>
</span><span id="horizon_zenith_angle-236"><a href="#horizon_zenith_angle-236"><span class="linenos">236</span></a>
</span><span id="horizon_zenith_angle-237"><a href="#horizon_zenith_angle-237"><span class="linenos">237</span></a>    <span class="c1">## Ellipsoidal Earth</span>
</span><span id="horizon_zenith_angle-238"><a href="#horizon_zenith_angle-238"><span class="linenos">238</span></a>    <span class="c1"># # Eccentricity of ellipsoid</span>
</span><span id="horizon_zenith_angle-239"><a href="#horizon_zenith_angle-239"><span class="linenos">239</span></a>    <span class="c1"># ecc = f * (2-f)</span>
</span><span id="horizon_zenith_angle-240"><a href="#horizon_zenith_angle-240"><span class="linenos">240</span></a>    <span class="c1"># # Local (i.e. prime vertical) radius of curvature at latitude</span>
</span><span id="horizon_zenith_angle-241"><a href="#horizon_zenith_angle-241"><span class="linenos">241</span></a>    <span class="c1"># N = r_earth / np.sqrt( 1 - ecc**2 * np.sin(lat*pi180)**2 )</span>
</span><span id="horizon_zenith_angle-242"><a href="#horizon_zenith_angle-242"><span class="linenos">242</span></a>    <span class="c1"># # Horizon zenith angle, degrees</span>
</span><span id="horizon_zenith_angle-243"><a href="#horizon_zenith_angle-243"><span class="linenos">243</span></a>    <span class="c1"># hza = 180 - np.arcsin( N / (N+alt) ) / pi180</span>
</span><span id="horizon_zenith_angle-244"><a href="#horizon_zenith_angle-244"><span class="linenos">244</span></a>
</span><span id="horizon_zenith_angle-245"><a href="#horizon_zenith_angle-245"><span class="linenos">245</span></a>    <span class="k">return</span> <span class="n">hza</span>
</span></pre></div>


            <div class="docstring"><p>Angle from the zenith to the horizon</p>

<p>The horizon is the locii of points where a line from the 
observation location to the ellipsoid is tangent to the ellipsoid surface.</p>

<p>The altitude parameter should be the vertical distance 
above the surrounding terrain that defines the horizon,
not necessarily the altitude above sea level or the altitude above ground level.
For example, on a mountain peak that is 4000 m above sea level and 
1500 m above the surrounding plateau, the relevant altitude is 1500 m.
For an observer on the plateau, the relevant altitude is 0 m.</p>

<p>The implementation below assumes a spherical Earth.
Results using the WGS84 ellipsoid (see commented code below)
differ from the spherical case by &lt;&lt; 1°. Terrain,
which is neglected here, has a larger effect on the horizon
location, so the simpler spherical calculation is appropriate. </p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>lat</strong> (float or ndarray):
latitude in degrees</li>
<li><strong>alt</strong> (float or ndarray):
altitude above surrounding terrain that defines the horizon, meters</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>hza</strong> (float or ndarray):
horizon zenith angle in degrees</li>
</ul>
</div>


                </section>
                <section id="solar_declination">
                            <input id="solar_declination-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">solar_declination</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">date</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="solar_declination-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#solar_declination"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="solar_declination-247"><a href="#solar_declination-247"><span class="linenos">247</span></a><span class="k">def</span> <span class="nf">solar_declination</span><span class="p">(</span> <span class="n">date</span> <span class="p">):</span>
</span><span id="solar_declination-248"><a href="#solar_declination-248"><span class="linenos">248</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Calculate solar declination (degrees) for specified date</span>
</span><span id="solar_declination-249"><a href="#solar_declination-249"><span class="linenos">249</span></a><span class="sd">    </span>
</span><span id="solar_declination-250"><a href="#solar_declination-250"><span class="linenos">250</span></a><span class="sd">    Implements Eq. 9.68-9.72 from M.Z. Jacobson, Fundamentals of Atmospheric Modeling</span>
</span><span id="solar_declination-251"><a href="#solar_declination-251"><span class="linenos">251</span></a><span class="sd">    </span>
</span><span id="solar_declination-252"><a href="#solar_declination-252"><span class="linenos">252</span></a><span class="sd">    Argument</span>
</span><span id="solar_declination-253"><a href="#solar_declination-253"><span class="linenos">253</span></a><span class="sd">    --------</span>
</span><span id="solar_declination-254"><a href="#solar_declination-254"><span class="linenos">254</span></a><span class="sd">    date : pandas.Timestamp, date, datetime, or str</span>
</span><span id="solar_declination-255"><a href="#solar_declination-255"><span class="linenos">255</span></a><span class="sd">        date for calculation</span>
</span><span id="solar_declination-256"><a href="#solar_declination-256"><span class="linenos">256</span></a>
</span><span id="solar_declination-257"><a href="#solar_declination-257"><span class="linenos">257</span></a><span class="sd">    Returns</span>
</span><span id="solar_declination-258"><a href="#solar_declination-258"><span class="linenos">258</span></a><span class="sd">    -------</span>
</span><span id="solar_declination-259"><a href="#solar_declination-259"><span class="linenos">259</span></a><span class="sd">    dec : float</span>
</span><span id="solar_declination-260"><a href="#solar_declination-260"><span class="linenos">260</span></a><span class="sd">        solar declination in degrees at the specified date</span>
</span><span id="solar_declination-261"><a href="#solar_declination-261"><span class="linenos">261</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="solar_declination-262"><a href="#solar_declination-262"><span class="linenos">262</span></a>
</span><span id="solar_declination-263"><a href="#solar_declination-263"><span class="linenos">263</span></a>    <span class="c1"># Convert to pandas Timestamp, if needed</span>
</span><span id="solar_declination-264"><a href="#solar_declination-264"><span class="linenos">264</span></a>    <span class="n">date</span> <span class="o">=</span> <span class="n">_to_timestamp</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
</span><span id="solar_declination-265"><a href="#solar_declination-265"><span class="linenos">265</span></a>
</span><span id="solar_declination-266"><a href="#solar_declination-266"><span class="linenos">266</span></a>     <span class="c1"># Number of days since beginning of 2000</span>
</span><span id="solar_declination-267"><a href="#solar_declination-267"><span class="linenos">267</span></a>    <span class="n">NJD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span> <span class="n">date</span><span class="o">.</span><span class="n">to_julian_date</span><span class="p">()</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_julian_date</span><span class="p">()</span> <span class="p">)</span>
</span><span id="solar_declination-268"><a href="#solar_declination-268"><span class="linenos">268</span></a>
</span><span id="solar_declination-269"><a href="#solar_declination-269"><span class="linenos">269</span></a>    <span class="c1"># Obliquity, degrees</span>
</span><span id="solar_declination-270"><a href="#solar_declination-270"><span class="linenos">270</span></a>    <span class="n">ob</span> <span class="o">=</span> <span class="mf">23.439</span> <span class="o">-</span> <span class="mf">4e-7</span> <span class="o">*</span> <span class="n">NJD</span>
</span><span id="solar_declination-271"><a href="#solar_declination-271"><span class="linenos">271</span></a>
</span><span id="solar_declination-272"><a href="#solar_declination-272"><span class="linenos">272</span></a>    <span class="c1"># Parameters for ecliptic, degrees</span>
</span><span id="solar_declination-273"><a href="#solar_declination-273"><span class="linenos">273</span></a>    <span class="n">gm</span> <span class="o">=</span> <span class="mf">357.528</span> <span class="o">+</span> <span class="mf">0.9856003</span> <span class="o">*</span> <span class="n">NJD</span>
</span><span id="solar_declination-274"><a href="#solar_declination-274"><span class="linenos">274</span></a>    <span class="n">lm</span> <span class="o">=</span> <span class="mf">280.460</span> <span class="o">+</span> <span class="mf">0.9856474</span> <span class="o">*</span> <span class="n">NJD</span>
</span><span id="solar_declination-275"><a href="#solar_declination-275"><span class="linenos">275</span></a>
</span><span id="solar_declination-276"><a href="#solar_declination-276"><span class="linenos">276</span></a>    <span class="c1"># Ecliptic longitude of sun, degrees</span>
</span><span id="solar_declination-277"><a href="#solar_declination-277"><span class="linenos">277</span></a>    <span class="n">ec</span> <span class="o">=</span> <span class="n">lm</span> <span class="o">+</span> <span class="mf">1.915</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">gm</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span> <span class="o">+</span> <span class="mf">0.020</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gm</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span>
</span><span id="solar_declination-278"><a href="#solar_declination-278"><span class="linenos">278</span></a>
</span><span id="solar_declination-279"><a href="#solar_declination-279"><span class="linenos">279</span></a>    <span class="c1">#Solar declination, degrees</span>
</span><span id="solar_declination-280"><a href="#solar_declination-280"><span class="linenos">280</span></a>    <span class="n">dec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">ob</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">ec</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">pi180</span>
</span><span id="solar_declination-281"><a href="#solar_declination-281"><span class="linenos">281</span></a>
</span><span id="solar_declination-282"><a href="#solar_declination-282"><span class="linenos">282</span></a>    <span class="k">return</span> <span class="n">dec</span>
</span></pre></div>


            <div class="docstring"><p>Calculate solar declination (degrees) for specified date</p>

<p>Implements Eq. 9.68-9.72 from M.Z. Jacobson, Fundamentals of Atmospheric Modeling</p>

<h6 id="argument">Argument</h6>

<p>date : pandas.Timestamp, date, datetime, or str
    date for calculation</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>dec</strong> (float):
solar declination in degrees at the specified date</li>
</ul>
</div>


                </section>
                <section id="solar_hour_angle">
                            <input id="solar_hour_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">solar_hour_angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">lon</span>, </span><span class="param"><span class="n">datetimeUTC</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="solar_hour_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#solar_hour_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="solar_hour_angle-284"><a href="#solar_hour_angle-284"><span class="linenos">284</span></a><span class="k">def</span> <span class="nf">solar_hour_angle</span><span class="p">(</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span> <span class="p">):</span>
</span><span id="solar_hour_angle-285"><a href="#solar_hour_angle-285"><span class="linenos">285</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Solar hour angle (degrees) for specified longitude, date and time</span>
</span><span id="solar_hour_angle-286"><a href="#solar_hour_angle-286"><span class="linenos">286</span></a>
</span><span id="solar_hour_angle-287"><a href="#solar_hour_angle-287"><span class="linenos">287</span></a><span class="sd">    Hour angle is the angular displacement of the sun from the local meridian.</span>
</span><span id="solar_hour_angle-288"><a href="#solar_hour_angle-288"><span class="linenos">288</span></a><span class="sd">    It is zero at local noon, negative in the morning, and positive is afternoon.</span>
</span><span id="solar_hour_angle-289"><a href="#solar_hour_angle-289"><span class="linenos">289</span></a><span class="sd">    </span>
</span><span id="solar_hour_angle-290"><a href="#solar_hour_angle-290"><span class="linenos">290</span></a><span class="sd">    Parameters</span>
</span><span id="solar_hour_angle-291"><a href="#solar_hour_angle-291"><span class="linenos">291</span></a><span class="sd">    ----------</span>
</span><span id="solar_hour_angle-292"><a href="#solar_hour_angle-292"><span class="linenos">292</span></a><span class="sd">    lon : float</span>
</span><span id="solar_hour_angle-293"><a href="#solar_hour_angle-293"><span class="linenos">293</span></a><span class="sd">        longitude in degrees east</span>
</span><span id="solar_hour_angle-294"><a href="#solar_hour_angle-294"><span class="linenos">294</span></a><span class="sd">    datetimeUTC : pandas.Timestamp or datetime</span>
</span><span id="solar_hour_angle-295"><a href="#solar_hour_angle-295"><span class="linenos">295</span></a><span class="sd">        date and time for calculation, must be UTC</span>
</span><span id="solar_hour_angle-296"><a href="#solar_hour_angle-296"><span class="linenos">296</span></a><span class="sd">    </span>
</span><span id="solar_hour_angle-297"><a href="#solar_hour_angle-297"><span class="linenos">297</span></a><span class="sd">    Returns</span>
</span><span id="solar_hour_angle-298"><a href="#solar_hour_angle-298"><span class="linenos">298</span></a><span class="sd">    -------</span>
</span><span id="solar_hour_angle-299"><a href="#solar_hour_angle-299"><span class="linenos">299</span></a><span class="sd">    ha : float</span>
</span><span id="solar_hour_angle-300"><a href="#solar_hour_angle-300"><span class="linenos">300</span></a><span class="sd">        hour angle in degrees at the specified location and time</span>
</span><span id="solar_hour_angle-301"><a href="#solar_hour_angle-301"><span class="linenos">301</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="solar_hour_angle-302"><a href="#solar_hour_angle-302"><span class="linenos">302</span></a>
</span><span id="solar_hour_angle-303"><a href="#solar_hour_angle-303"><span class="linenos">303</span></a>    <span class="c1"># Convert to pandas Timestamp, if needed</span>
</span><span id="solar_hour_angle-304"><a href="#solar_hour_angle-304"><span class="linenos">304</span></a>    <span class="n">datetimeUTC</span> <span class="o">=</span> <span class="n">_to_timestamp</span><span class="p">(</span><span class="n">datetimeUTC</span><span class="p">)</span>
</span><span id="solar_hour_angle-305"><a href="#solar_hour_angle-305"><span class="linenos">305</span></a>
</span><span id="solar_hour_angle-306"><a href="#solar_hour_angle-306"><span class="linenos">306</span></a>    <span class="c1"># Hour angle for mean solar time.</span>
</span><span id="solar_hour_angle-307"><a href="#solar_hour_angle-307"><span class="linenos">307</span></a>    <span class="c1"># Actual solar position has a small offset given by the equation of time (below)</span>
</span><span id="solar_hour_angle-308"><a href="#solar_hour_angle-308"><span class="linenos">308</span></a>    <span class="n">Ha</span> <span class="o">=</span> <span class="p">(</span> <span class="n">datetimeUTC</span><span class="o">.</span><span class="n">hour</span> <span class="o">+</span> <span class="n">datetimeUTC</span><span class="o">.</span><span class="n">minute</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">-</span> <span class="mi">12</span> <span class="p">)</span> <span class="o">*</span> <span class="mi">15</span> <span class="o">+</span> <span class="n">lon</span>
</span><span id="solar_hour_angle-309"><a href="#solar_hour_angle-309"><span class="linenos">309</span></a>
</span><span id="solar_hour_angle-310"><a href="#solar_hour_angle-310"><span class="linenos">310</span></a>    <span class="c1"># Add equation of time to the hour angle, degrees</span>
</span><span id="solar_hour_angle-311"><a href="#solar_hour_angle-311"><span class="linenos">311</span></a>    <span class="n">Ha</span> <span class="o">+=</span> <span class="n">equation_of_time</span><span class="p">(</span> <span class="n">datetimeUTC</span> <span class="p">)</span>
</span><span id="solar_hour_angle-312"><a href="#solar_hour_angle-312"><span class="linenos">312</span></a>
</span><span id="solar_hour_angle-313"><a href="#solar_hour_angle-313"><span class="linenos">313</span></a>    <span class="k">return</span> <span class="n">Ha</span>
</span></pre></div>


            <div class="docstring"><p>Solar hour angle (degrees) for specified longitude, date and time</p>

<p>Hour angle is the angular displacement of the sun from the local meridian.
It is zero at local noon, negative in the morning, and positive is afternoon.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>lon</strong> (float):
longitude in degrees east</li>
<li><strong>datetimeUTC</strong> (pandas.Timestamp or datetime):
date and time for calculation, must be UTC</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ha</strong> (float):
hour angle in degrees at the specified location and time</li>
</ul>
</div>


                </section>
                <section id="refraction_angle">
                            <input id="refraction_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">refraction_angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">true_elevation_angle</span>, </span><span class="param"><span class="n">pressure</span><span class="o">=</span><span class="mf">101325.0</span>, </span><span class="param"><span class="n">temperature_celsius</span><span class="o">=</span><span class="mf">10.0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="refraction_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#refraction_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="refraction_angle-315"><a href="#refraction_angle-315"><span class="linenos">315</span></a><span class="k">def</span> <span class="nf">refraction_angle</span><span class="p">(</span> <span class="n">true_elevation_angle</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="mf">101325.</span><span class="p">,</span> <span class="n">temperature_celsius</span><span class="o">=</span><span class="mf">10.</span> <span class="p">):</span>
</span><span id="refraction_angle-316"><a href="#refraction_angle-316"><span class="linenos">316</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Atmospheric refraction angle for light passing through Earth&#39;s atmosphere</span>
</span><span id="refraction_angle-317"><a href="#refraction_angle-317"><span class="linenos">317</span></a>
</span><span id="refraction_angle-318"><a href="#refraction_angle-318"><span class="linenos">318</span></a><span class="sd">    The apparent locations in the sky of objects outsides Earth&#39;s atmosphere </span>
</span><span id="refraction_angle-319"><a href="#refraction_angle-319"><span class="linenos">319</span></a><span class="sd">    differs from their true locations due to atmospheric refraction. </span>
</span><span id="refraction_angle-320"><a href="#refraction_angle-320"><span class="linenos">320</span></a><span class="sd">    (e.g. sun and moon when they rise and set)</span>
</span><span id="refraction_angle-321"><a href="#refraction_angle-321"><span class="linenos">321</span></a><span class="sd">    The apparent elevation of an object above the horizon is</span>
</span><span id="refraction_angle-322"><a href="#refraction_angle-322"><span class="linenos">322</span></a><span class="sd">    apparent elevation angle = (true elevation angle) + (refraction angle)</span>
</span><span id="refraction_angle-323"><a href="#refraction_angle-323"><span class="linenos">323</span></a><span class="sd">    </span>
</span><span id="refraction_angle-324"><a href="#refraction_angle-324"><span class="linenos">324</span></a><span class="sd">    The equations here are from Saemundsson/Bennett, whose calculations use</span>
</span><span id="refraction_angle-325"><a href="#refraction_angle-325"><span class="linenos">325</span></a><span class="sd">    a typical vertical profile of atmospheric density (i.e. temperature and pressure).</span>
</span><span id="refraction_angle-326"><a href="#refraction_angle-326"><span class="linenos">326</span></a><span class="sd">    The profiles can be rescaled to a particular surface temperature and pressure</span>
</span><span id="refraction_angle-327"><a href="#refraction_angle-327"><span class="linenos">327</span></a><span class="sd">    to approximately account for varying atmospheric conditions.</span>
</span><span id="refraction_angle-328"><a href="#refraction_angle-328"><span class="linenos">328</span></a><span class="sd">    Accurate refraction calculations should use fully specified vertical profile</span>
</span><span id="refraction_angle-329"><a href="#refraction_angle-329"><span class="linenos">329</span></a><span class="sd">    of temperature and pressure, which cannot be done here.</span>
</span><span id="refraction_angle-330"><a href="#refraction_angle-330"><span class="linenos">330</span></a>
</span><span id="refraction_angle-331"><a href="#refraction_angle-331"><span class="linenos">331</span></a><span class="sd">    Parameters</span>
</span><span id="refraction_angle-332"><a href="#refraction_angle-332"><span class="linenos">332</span></a><span class="sd">    ----------</span>
</span><span id="refraction_angle-333"><a href="#refraction_angle-333"><span class="linenos">333</span></a><span class="sd">    true_elevation_angle : float</span>
</span><span id="refraction_angle-334"><a href="#refraction_angle-334"><span class="linenos">334</span></a><span class="sd">        degrees above horizon of sun or other object</span>
</span><span id="refraction_angle-335"><a href="#refraction_angle-335"><span class="linenos">335</span></a><span class="sd">    pressure : float (default=101325)</span>
</span><span id="refraction_angle-336"><a href="#refraction_angle-336"><span class="linenos">336</span></a><span class="sd">        surface atmospheric pressure (Pa)</span>
</span><span id="refraction_angle-337"><a href="#refraction_angle-337"><span class="linenos">337</span></a><span class="sd">    temperature_celsius : float (default=10)</span>
</span><span id="refraction_angle-338"><a href="#refraction_angle-338"><span class="linenos">338</span></a><span class="sd">        surface atmospheric temperature (C)</span>
</span><span id="refraction_angle-339"><a href="#refraction_angle-339"><span class="linenos">339</span></a>
</span><span id="refraction_angle-340"><a href="#refraction_angle-340"><span class="linenos">340</span></a><span class="sd">    Returns</span>
</span><span id="refraction_angle-341"><a href="#refraction_angle-341"><span class="linenos">341</span></a><span class="sd">    -------</span>
</span><span id="refraction_angle-342"><a href="#refraction_angle-342"><span class="linenos">342</span></a><span class="sd">    angle : float</span>
</span><span id="refraction_angle-343"><a href="#refraction_angle-343"><span class="linenos">343</span></a><span class="sd">        refraction angle in degrees. Value is zero when apparent elevation is below horizon</span>
</span><span id="refraction_angle-344"><a href="#refraction_angle-344"><span class="linenos">344</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="refraction_angle-345"><a href="#refraction_angle-345"><span class="linenos">345</span></a>    <span class="c1"># Refraction angle, arcminutes</span>
</span><span id="refraction_angle-346"><a href="#refraction_angle-346"><span class="linenos">346</span></a>    <span class="n">R</span> <span class="o">=</span> <span class="mf">1.02</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span> <span class="p">(</span> <span class="n">true_elevation_angle</span> <span class="o">+</span> <span class="mf">10.3</span> <span class="o">/</span> <span class="p">(</span><span class="n">true_elevation_angle</span> <span class="o">+</span> <span class="mf">5.11</span><span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span>
</span><span id="refraction_angle-347"><a href="#refraction_angle-347"><span class="linenos">347</span></a>    <span class="c1"># Account for temperature and pressure, arcminutes</span>
</span><span id="refraction_angle-348"><a href="#refraction_angle-348"><span class="linenos">348</span></a>    <span class="n">R</span> <span class="o">=</span> <span class="n">R</span> <span class="o">*</span> <span class="n">pressure</span> <span class="o">/</span> <span class="mi">101325</span> <span class="o">*</span> <span class="mi">283</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">273</span> <span class="o">+</span> <span class="n">temperature_celsius</span> <span class="p">)</span>
</span><span id="refraction_angle-349"><a href="#refraction_angle-349"><span class="linenos">349</span></a>    <span class="c1"># Convert arcminutes -&gt; degrees</span>
</span><span id="refraction_angle-350"><a href="#refraction_angle-350"><span class="linenos">350</span></a>    <span class="n">R</span> <span class="o">/=</span> <span class="mi">60</span>
</span><span id="refraction_angle-351"><a href="#refraction_angle-351"><span class="linenos">351</span></a>
</span><span id="refraction_angle-352"><a href="#refraction_angle-352"><span class="linenos">352</span></a>    <span class="c1"># Result must be positive</span>
</span><span id="refraction_angle-353"><a href="#refraction_angle-353"><span class="linenos">353</span></a>    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="refraction_angle-354"><a href="#refraction_angle-354"><span class="linenos">354</span></a>
</span><span id="refraction_angle-355"><a href="#refraction_angle-355"><span class="linenos">355</span></a>    <span class="c1"># Refraction defined only when the apparent elevation angle is positive</span>
</span><span id="refraction_angle-356"><a href="#refraction_angle-356"><span class="linenos">356</span></a>    <span class="c1"># Set refraction to zero when the apparent elevation is below horizon</span>
</span><span id="refraction_angle-357"><a href="#refraction_angle-357"><span class="linenos">357</span></a>    <span class="n">refraction_angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span> <span class="n">true_elevation_angle</span> <span class="o">+</span> <span class="n">R</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
</span><span id="refraction_angle-358"><a href="#refraction_angle-358"><span class="linenos">358</span></a>
</span><span id="refraction_angle-359"><a href="#refraction_angle-359"><span class="linenos">359</span></a>    <span class="k">return</span> <span class="n">refraction_angle</span>
</span></pre></div>


            <div class="docstring"><p>Atmospheric refraction angle for light passing through Earth's atmosphere</p>

<p>The apparent locations in the sky of objects outsides Earth's atmosphere 
differs from their true locations due to atmospheric refraction. 
(e.g. sun and moon when they rise and set)
The apparent elevation of an object above the horizon is
apparent elevation angle = (true elevation angle) + (refraction angle)</p>

<p>The equations here are from Saemundsson/Bennett, whose calculations use
a typical vertical profile of atmospheric density (i.e. temperature and pressure).
The profiles can be rescaled to a particular surface temperature and pressure
to approximately account for varying atmospheric conditions.
Accurate refraction calculations should use fully specified vertical profile
of temperature and pressure, which cannot be done here.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>true_elevation_angle</strong> (float):
degrees above horizon of sun or other object</li>
<li><strong>pressure</strong> (float (default=101325)):
surface atmospheric pressure (Pa)</li>
<li><strong>temperature_celsius</strong> (float (default=10)):
surface atmospheric temperature (C)</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>angle</strong> (float):
refraction angle in degrees. Value is zero when apparent elevation is below horizon</li>
</ul>
</div>


                </section>
                <section id="sza">
                            <input id="sza-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sza</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">lat</span>,</span><span class="param">	<span class="n">lon</span>,</span><span class="param">	<span class="n">datetimeUTC</span>,</span><span class="param">	<span class="n">refraction</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">temperature</span><span class="o">=</span><span class="mf">10.0</span>,</span><span class="param">	<span class="n">pressure</span><span class="o">=</span><span class="mf">101325.0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="sza-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sza"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sza-105"><a href="#sza-105"><span class="linenos">105</span></a><span class="k">def</span> <span class="nf">solar_zenith_angle</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span><span class="p">,</span> 
</span><span id="sza-106"><a href="#sza-106"><span class="linenos">106</span></a>                       <span class="n">refraction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="mf">101325.</span> <span class="p">):</span>
</span><span id="sza-107"><a href="#sza-107"><span class="linenos">107</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Solar zenith angle (degrees) for a given latitude, longitude, date and time.</span>
</span><span id="sza-108"><a href="#sza-108"><span class="linenos">108</span></a><span class="sd">    </span>
</span><span id="sza-109"><a href="#sza-109"><span class="linenos">109</span></a><span class="sd">    Accounts for equation of time and (optionally) for atmospheric refraction.</span>
</span><span id="sza-110"><a href="#sza-110"><span class="linenos">110</span></a><span class="sd">    Altitude of the observer is not accounted for, which can be important when the sun </span>
</span><span id="sza-111"><a href="#sza-111"><span class="linenos">111</span></a><span class="sd">    is near the horizon. </span>
</span><span id="sza-112"><a href="#sza-112"><span class="linenos">112</span></a><span class="sd">    </span>
</span><span id="sza-113"><a href="#sza-113"><span class="linenos">113</span></a><span class="sd">    Results are accurate to tenths of a degree, except where altitude is important</span>
</span><span id="sza-114"><a href="#sza-114"><span class="linenos">114</span></a><span class="sd">    (&lt; 20 degrees solar elevation)</span>
</span><span id="sza-115"><a href="#sza-115"><span class="linenos">115</span></a>
</span><span id="sza-116"><a href="#sza-116"><span class="linenos">116</span></a><span class="sd">    Parameters</span>
</span><span id="sza-117"><a href="#sza-117"><span class="linenos">117</span></a><span class="sd">    ----------</span>
</span><span id="sza-118"><a href="#sza-118"><span class="linenos">118</span></a><span class="sd">    lat : float or ndarray</span>
</span><span id="sza-119"><a href="#sza-119"><span class="linenos">119</span></a><span class="sd">        latitude in degrees</span>
</span><span id="sza-120"><a href="#sza-120"><span class="linenos">120</span></a><span class="sd">    lon : float or ndarray</span>
</span><span id="sza-121"><a href="#sza-121"><span class="linenos">121</span></a><span class="sd">        longitudes in degrees</span>
</span><span id="sza-122"><a href="#sza-122"><span class="linenos">122</span></a><span class="sd">    datetimeUTC : pandas.Timestamp, datetime, or str</span>
</span><span id="sza-123"><a href="#sza-123"><span class="linenos">123</span></a><span class="sd">        date and time in UTC</span>
</span><span id="sza-124"><a href="#sza-124"><span class="linenos">124</span></a><span class="sd">    refraction : bool, optional (default=False)</span>
</span><span id="sza-125"><a href="#sza-125"><span class="linenos">125</span></a><span class="sd">        specifies whether to account for atmospheric refraction</span>
</span><span id="sza-126"><a href="#sza-126"><span class="linenos">126</span></a><span class="sd">    temperature : float or ndarray, optional (default=10)</span>
</span><span id="sza-127"><a href="#sza-127"><span class="linenos">127</span></a><span class="sd">        surface atmospheric temperature (Celsius), only used for refraction calculation</span>
</span><span id="sza-128"><a href="#sza-128"><span class="linenos">128</span></a><span class="sd">    pressure : float or ndarray, optional (default=101325)</span>
</span><span id="sza-129"><a href="#sza-129"><span class="linenos">129</span></a><span class="sd">        surface atmospheric pressure (Pa), only used for refraction calculation</span>
</span><span id="sza-130"><a href="#sza-130"><span class="linenos">130</span></a><span class="sd">    </span>
</span><span id="sza-131"><a href="#sza-131"><span class="linenos">131</span></a><span class="sd">    Returns</span>
</span><span id="sza-132"><a href="#sza-132"><span class="linenos">132</span></a><span class="sd">    -------</span>
</span><span id="sza-133"><a href="#sza-133"><span class="linenos">133</span></a><span class="sd">    sza : float or ndarray</span>
</span><span id="sza-134"><a href="#sza-134"><span class="linenos">134</span></a><span class="sd">        solar zenith angle in degrees at the designated locations and times</span>
</span><span id="sza-135"><a href="#sza-135"><span class="linenos">135</span></a><span class="sd">        If refraction=False, this is the true solar zenith angle</span>
</span><span id="sza-136"><a href="#sza-136"><span class="linenos">136</span></a><span class="sd">        If refraction=True, this is the apparent solar zenith angle</span>
</span><span id="sza-137"><a href="#sza-137"><span class="linenos">137</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="sza-138"><a href="#sza-138"><span class="linenos">138</span></a>    <span class="c1"># Convert to pandas Timestamp, if needed</span>
</span><span id="sza-139"><a href="#sza-139"><span class="linenos">139</span></a>    <span class="n">datetimeUTC</span> <span class="o">=</span> <span class="n">_to_timestamp</span><span class="p">(</span><span class="n">datetimeUTC</span><span class="p">)</span>
</span><span id="sza-140"><a href="#sza-140"><span class="linenos">140</span></a>
</span><span id="sza-141"><a href="#sza-141"><span class="linenos">141</span></a>    <span class="c1"># Solar declination, degrees</span>
</span><span id="sza-142"><a href="#sza-142"><span class="linenos">142</span></a>    <span class="n">dec</span> <span class="o">=</span> <span class="n">solar_declination</span><span class="p">(</span> <span class="n">datetimeUTC</span> <span class="p">)</span>
</span><span id="sza-143"><a href="#sza-143"><span class="linenos">143</span></a>
</span><span id="sza-144"><a href="#sza-144"><span class="linenos">144</span></a>    <span class="c1"># Hour angle, degrees</span>
</span><span id="sza-145"><a href="#sza-145"><span class="linenos">145</span></a>    <span class="n">Ha</span> <span class="o">=</span> <span class="n">solar_hour_angle</span><span class="p">(</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span> <span class="p">)</span>
</span><span id="sza-146"><a href="#sza-146"><span class="linenos">146</span></a>
</span><span id="sza-147"><a href="#sza-147"><span class="linenos">147</span></a>    <span class="c1"># True solar zenith angle, radians</span>
</span><span id="sza-148"><a href="#sza-148"><span class="linenos">148</span></a>    <span class="n">sza</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dec</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="o">+</span> \
</span><span id="sza-149"><a href="#sza-149"><span class="linenos">149</span></a>          <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dec</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">Ha</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="p">)</span>
</span><span id="sza-150"><a href="#sza-150"><span class="linenos">150</span></a>
</span><span id="sza-151"><a href="#sza-151"><span class="linenos">151</span></a>    <span class="c1"># Convert radians -&gt; degrees</span>
</span><span id="sza-152"><a href="#sza-152"><span class="linenos">152</span></a>    <span class="n">sza</span> <span class="o">/=</span> <span class="n">pi180</span>
</span><span id="sza-153"><a href="#sza-153"><span class="linenos">153</span></a>
</span><span id="sza-154"><a href="#sza-154"><span class="linenos">154</span></a>    <span class="k">if</span> <span class="n">refraction</span><span class="p">:</span>
</span><span id="sza-155"><a href="#sza-155"><span class="linenos">155</span></a>        <span class="c1"># Subtract refraction angle (degrees) from zenith angle.</span>
</span><span id="sza-156"><a href="#sza-156"><span class="linenos">156</span></a>        <span class="c1"># SZA is always smaller due to refraction.</span>
</span><span id="sza-157"><a href="#sza-157"><span class="linenos">157</span></a>        <span class="n">sza</span> <span class="o">-=</span> <span class="n">refraction_angle</span><span class="p">(</span> <span class="mi">90</span><span class="o">-</span><span class="n">sza</span><span class="p">,</span> <span class="n">pressure</span><span class="p">,</span> <span class="n">temperature</span> <span class="p">)</span>
</span><span id="sza-158"><a href="#sza-158"><span class="linenos">158</span></a>
</span><span id="sza-159"><a href="#sza-159"><span class="linenos">159</span></a>    <span class="k">return</span> <span class="n">sza</span>
</span></pre></div>


            <div class="docstring"><p>Solar zenith angle (degrees) for a given latitude, longitude, date and time.</p>

<p>Accounts for equation of time and (optionally) for atmospheric refraction.
Altitude of the observer is not accounted for, which can be important when the sun 
is near the horizon. </p>

<p>Results are accurate to tenths of a degree, except where altitude is important
(&lt; 20 degrees solar elevation)</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>lat</strong> (float or ndarray):
latitude in degrees</li>
<li><strong>lon</strong> (float or ndarray):
longitudes in degrees</li>
<li><strong>datetimeUTC</strong> (pandas.Timestamp, datetime, or str):
date and time in UTC</li>
<li><strong>refraction</strong> (bool, optional (default=False)):
specifies whether to account for atmospheric refraction</li>
<li><strong>temperature</strong> (float or ndarray, optional (default=10)):
surface atmospheric temperature (Celsius), only used for refraction calculation</li>
<li><strong>pressure</strong> (float or ndarray, optional (default=101325)):
surface atmospheric pressure (Pa), only used for refraction calculation</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>sza</strong> (float or ndarray):
solar zenith angle in degrees at the designated locations and times
If refraction=False, this is the true solar zenith angle
If refraction=True, this is the apparent solar zenith angle</li>
</ul>
</div>


                </section>
                <section id="saa">
                            <input id="saa-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">saa</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">lat</span>, </span><span class="param"><span class="n">lon</span>, </span><span class="param"><span class="n">datetimeUTC</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="saa-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#saa"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="saa-16"><a href="#saa-16"><span class="linenos">16</span></a><span class="k">def</span> <span class="nf">solar_azimuth_angle</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span> <span class="p">):</span>
</span><span id="saa-17"><a href="#saa-17"><span class="linenos">17</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Solar azimuth angle (degrees) for a latitude, longitude, date and time</span>
</span><span id="saa-18"><a href="#saa-18"><span class="linenos">18</span></a><span class="sd">    </span>
</span><span id="saa-19"><a href="#saa-19"><span class="linenos">19</span></a><span class="sd">    SAA is degrees clockwise from north.</span>
</span><span id="saa-20"><a href="#saa-20"><span class="linenos">20</span></a><span class="sd">    </span>
</span><span id="saa-21"><a href="#saa-21"><span class="linenos">21</span></a><span class="sd">    Parameters</span>
</span><span id="saa-22"><a href="#saa-22"><span class="linenos">22</span></a><span class="sd">    ----------</span>
</span><span id="saa-23"><a href="#saa-23"><span class="linenos">23</span></a><span class="sd">    lat : float or ndarray</span>
</span><span id="saa-24"><a href="#saa-24"><span class="linenos">24</span></a><span class="sd">        latitude in degrees</span>
</span><span id="saa-25"><a href="#saa-25"><span class="linenos">25</span></a><span class="sd">    lon : float or ndarray</span>
</span><span id="saa-26"><a href="#saa-26"><span class="linenos">26</span></a><span class="sd">        longitudes in degrees</span>
</span><span id="saa-27"><a href="#saa-27"><span class="linenos">27</span></a><span class="sd">    datetimeUTC : pandas.Timestamp, datetime, or str</span>
</span><span id="saa-28"><a href="#saa-28"><span class="linenos">28</span></a><span class="sd">        date and time in UTC</span>
</span><span id="saa-29"><a href="#saa-29"><span class="linenos">29</span></a>
</span><span id="saa-30"><a href="#saa-30"><span class="linenos">30</span></a><span class="sd">    Returns</span>
</span><span id="saa-31"><a href="#saa-31"><span class="linenos">31</span></a><span class="sd">    -------</span>
</span><span id="saa-32"><a href="#saa-32"><span class="linenos">32</span></a><span class="sd">    saa : float or ndarray</span>
</span><span id="saa-33"><a href="#saa-33"><span class="linenos">33</span></a><span class="sd">        solar azimuth angle in degrees (clockwise from north)</span>
</span><span id="saa-34"><a href="#saa-34"><span class="linenos">34</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="saa-35"><a href="#saa-35"><span class="linenos">35</span></a>    <span class="c1"># Convert to pandas Timestamp, if needed</span>
</span><span id="saa-36"><a href="#saa-36"><span class="linenos">36</span></a>    <span class="n">datetimeUTC</span> <span class="o">=</span> <span class="n">_to_timestamp</span><span class="p">(</span><span class="n">datetimeUTC</span><span class="p">)</span>
</span><span id="saa-37"><a href="#saa-37"><span class="linenos">37</span></a>
</span><span id="saa-38"><a href="#saa-38"><span class="linenos">38</span></a>    <span class="c1"># Solar declination, degrees</span>
</span><span id="saa-39"><a href="#saa-39"><span class="linenos">39</span></a>    <span class="n">dec</span> <span class="o">=</span> <span class="n">solar_declination</span><span class="p">(</span> <span class="n">datetimeUTC</span> <span class="p">)</span>
</span><span id="saa-40"><a href="#saa-40"><span class="linenos">40</span></a>
</span><span id="saa-41"><a href="#saa-41"><span class="linenos">41</span></a>    <span class="c1"># Hour angle, degrees</span>
</span><span id="saa-42"><a href="#saa-42"><span class="linenos">42</span></a>    <span class="n">Ha</span> <span class="o">=</span> <span class="n">solar_hour_angle</span><span class="p">(</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span> <span class="p">)</span>
</span><span id="saa-43"><a href="#saa-43"><span class="linenos">43</span></a>
</span><span id="saa-44"><a href="#saa-44"><span class="linenos">44</span></a>    <span class="c1"># Solar zenith angle, degrees</span>
</span><span id="saa-45"><a href="#saa-45"><span class="linenos">45</span></a>    <span class="c1"># Use true sza, without refraction</span>
</span><span id="saa-46"><a href="#saa-46"><span class="linenos">46</span></a>    <span class="n">zen</span> <span class="o">=</span> <span class="n">sza</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span><span class="p">,</span> <span class="n">refraction</span><span class="o">=</span><span class="kc">False</span> <span class="p">)</span>
</span><span id="saa-47"><a href="#saa-47"><span class="linenos">47</span></a>
</span><span id="saa-48"><a href="#saa-48"><span class="linenos">48</span></a>    <span class="c1"># Solar azimuth angle, degrees</span>
</span><span id="saa-49"><a href="#saa-49"><span class="linenos">49</span></a>    <span class="n">saa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">Ha</span><span class="o">*</span><span class="n">pi180</span> <span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span> <span class="n">dec</span><span class="o">*</span><span class="n">pi180</span> <span class="p">)</span> <span class="o">/</span>
</span><span id="saa-50"><a href="#saa-50"><span class="linenos">50</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">zen</span><span class="o">*</span><span class="n">pi180</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">pi180</span>
</span><span id="saa-51"><a href="#saa-51"><span class="linenos">51</span></a>
</span><span id="saa-52"><a href="#saa-52"><span class="linenos">52</span></a>    <span class="c1"># Change range [-180,180] to [0,360]</span>
</span><span id="saa-53"><a href="#saa-53"><span class="linenos">53</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span> <span class="n">saa</span><span class="o">+</span><span class="mi">360</span><span class="p">,</span> <span class="mi">360</span> <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Solar azimuth angle (degrees) for a latitude, longitude, date and time</p>

<p>SAA is degrees clockwise from north.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>lat</strong> (float or ndarray):
latitude in degrees</li>
<li><strong>lon</strong> (float or ndarray):
longitudes in degrees</li>
<li><strong>datetimeUTC</strong> (pandas.Timestamp, datetime, or str):
date and time in UTC</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>saa</strong> (float or ndarray):
solar azimuth angle in degrees (clockwise from north)</li>
</ul>
</div>


                </section>
                <section id="sea">
                            <input id="sea-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sea</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">lat</span>,</span><span class="param">	<span class="n">lon</span>,</span><span class="param">	<span class="n">alt</span>,</span><span class="param">	<span class="n">datetimeUTC</span>,</span><span class="param">	<span class="n">refraction</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">temperature</span><span class="o">=</span><span class="mf">10.0</span>,</span><span class="param">	<span class="n">pressure</span><span class="o">=</span><span class="mf">101325.0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="sea-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sea"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sea-55"><a href="#sea-55"><span class="linenos"> 55</span></a><span class="k">def</span> <span class="nf">solar_elevation_angle</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">datetimeUTC</span><span class="p">,</span>
</span><span id="sea-56"><a href="#sea-56"><span class="linenos"> 56</span></a>                       <span class="n">refraction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="mf">101325.</span> <span class="p">):</span>
</span><span id="sea-57"><a href="#sea-57"><span class="linenos"> 57</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Solar elevation angle (degrees) above the horizon</span>
</span><span id="sea-58"><a href="#sea-58"><span class="linenos"> 58</span></a>
</span><span id="sea-59"><a href="#sea-59"><span class="linenos"> 59</span></a><span class="sd">    The altitude parameter should be the vertical distance </span>
</span><span id="sea-60"><a href="#sea-60"><span class="linenos"> 60</span></a><span class="sd">    above the surrounding terrain that defines the horizon,</span>
</span><span id="sea-61"><a href="#sea-61"><span class="linenos"> 61</span></a><span class="sd">    not necessarily the altitude above sea level or the altitude above ground level.</span>
</span><span id="sea-62"><a href="#sea-62"><span class="linenos"> 62</span></a><span class="sd">    For example, on a mountain peak that is 4000 m above sea level and </span>
</span><span id="sea-63"><a href="#sea-63"><span class="linenos"> 63</span></a><span class="sd">    1500 m above the surrounding plateau, the relevant altitude is 1500 m.</span>
</span><span id="sea-64"><a href="#sea-64"><span class="linenos"> 64</span></a><span class="sd">    For an observer on the plateau, the relevant altitude is 0 m.</span>
</span><span id="sea-65"><a href="#sea-65"><span class="linenos"> 65</span></a>
</span><span id="sea-66"><a href="#sea-66"><span class="linenos"> 66</span></a><span class="sd">    See documentation for `solar_zenith_angle` and `horizon_zenith_angle`.</span>
</span><span id="sea-67"><a href="#sea-67"><span class="linenos"> 67</span></a>
</span><span id="sea-68"><a href="#sea-68"><span class="linenos"> 68</span></a><span class="sd">    Parameters</span>
</span><span id="sea-69"><a href="#sea-69"><span class="linenos"> 69</span></a><span class="sd">    ----------</span>
</span><span id="sea-70"><a href="#sea-70"><span class="linenos"> 70</span></a><span class="sd">    lat : float or ndarray</span>
</span><span id="sea-71"><a href="#sea-71"><span class="linenos"> 71</span></a><span class="sd">        latitude in degrees</span>
</span><span id="sea-72"><a href="#sea-72"><span class="linenos"> 72</span></a><span class="sd">    lon : float or ndarray</span>
</span><span id="sea-73"><a href="#sea-73"><span class="linenos"> 73</span></a><span class="sd">        longitudes in degrees</span>
</span><span id="sea-74"><a href="#sea-74"><span class="linenos"> 74</span></a><span class="sd">    alt : float or ndarray</span>
</span><span id="sea-75"><a href="#sea-75"><span class="linenos"> 75</span></a><span class="sd">        altitude above surrounding terrain that defines the horizon, meters</span>
</span><span id="sea-76"><a href="#sea-76"><span class="linenos"> 76</span></a><span class="sd">    datetimeUTC : pandas.Timestamp, datetime, or str</span>
</span><span id="sea-77"><a href="#sea-77"><span class="linenos"> 77</span></a><span class="sd">        date and time in UTC</span>
</span><span id="sea-78"><a href="#sea-78"><span class="linenos"> 78</span></a><span class="sd">    refraction : bool, optional (default=False)</span>
</span><span id="sea-79"><a href="#sea-79"><span class="linenos"> 79</span></a><span class="sd">        specifies whether to account for atmospheric refraction</span>
</span><span id="sea-80"><a href="#sea-80"><span class="linenos"> 80</span></a><span class="sd">    temperature : float or ndarray, optional (default=10)</span>
</span><span id="sea-81"><a href="#sea-81"><span class="linenos"> 81</span></a><span class="sd">        surface atmospheric temperature (Celsius), only used for refraction calculation</span>
</span><span id="sea-82"><a href="#sea-82"><span class="linenos"> 82</span></a><span class="sd">    pressure : float or ndarray, optional (default=101325)</span>
</span><span id="sea-83"><a href="#sea-83"><span class="linenos"> 83</span></a><span class="sd">        surface atmospheric pressure (Pa), only used for refraction calculation</span>
</span><span id="sea-84"><a href="#sea-84"><span class="linenos"> 84</span></a><span class="sd">    </span>
</span><span id="sea-85"><a href="#sea-85"><span class="linenos"> 85</span></a><span class="sd">    Returns</span>
</span><span id="sea-86"><a href="#sea-86"><span class="linenos"> 86</span></a><span class="sd">    -------</span>
</span><span id="sea-87"><a href="#sea-87"><span class="linenos"> 87</span></a><span class="sd">    sea : float or ndarray</span>
</span><span id="sea-88"><a href="#sea-88"><span class="linenos"> 88</span></a><span class="sd">        solar elevation angle in degrees at the designated locations and times</span>
</span><span id="sea-89"><a href="#sea-89"><span class="linenos"> 89</span></a><span class="sd">        If refraction=False, this is the true solar elevation angle</span>
</span><span id="sea-90"><a href="#sea-90"><span class="linenos"> 90</span></a><span class="sd">        If refraction=True, this is the apparent solar elevation angle</span>
</span><span id="sea-91"><a href="#sea-91"><span class="linenos"> 91</span></a><span class="sd">    </span>
</span><span id="sea-92"><a href="#sea-92"><span class="linenos"> 92</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="sea-93"><a href="#sea-93"><span class="linenos"> 93</span></a>
</span><span id="sea-94"><a href="#sea-94"><span class="linenos"> 94</span></a>    <span class="k">if</span> <span class="n">refraction</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">alt</span><span class="p">):</span>
</span><span id="sea-95"><a href="#sea-95"><span class="linenos"> 95</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span> <span class="s1">&#39;Atmospheric refraction is calculated for surface conditions, &#39;</span>
</span><span id="sea-96"><a href="#sea-96"><span class="linenos"> 96</span></a>                    <span class="o">+</span> <span class="s1">&#39;but an altitude above the surface was specified&#39;</span><span class="p">,</span>
</span><span id="sea-97"><a href="#sea-97"><span class="linenos"> 97</span></a>                     <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">,</span>
</span><span id="sea-98"><a href="#sea-98"><span class="linenos"> 98</span></a>                     <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span> <span class="p">)</span>
</span><span id="sea-99"><a href="#sea-99"><span class="linenos"> 99</span></a>
</span><span id="sea-100"><a href="#sea-100"><span class="linenos">100</span></a>    <span class="n">sea</span> <span class="o">=</span> <span class="n">horizon_zenith_angle</span><span class="p">(</span> <span class="n">alt</span> <span class="p">)</span> \
</span><span id="sea-101"><a href="#sea-101"><span class="linenos">101</span></a>         <span class="o">-</span> <span class="n">solar_zenith_angle</span><span class="p">(</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">datetimeUTC</span><span class="p">,</span> <span class="n">refraction</span><span class="p">,</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">pressure</span> <span class="p">)</span>
</span><span id="sea-102"><a href="#sea-102"><span class="linenos">102</span></a>
</span><span id="sea-103"><a href="#sea-103"><span class="linenos">103</span></a>    <span class="k">return</span> <span class="n">sea</span>
</span></pre></div>


            <div class="docstring"><p>Solar elevation angle (degrees) above the horizon</p>

<p>The altitude parameter should be the vertical distance 
above the surrounding terrain that defines the horizon,
not necessarily the altitude above sea level or the altitude above ground level.
For example, on a mountain peak that is 4000 m above sea level and 
1500 m above the surrounding plateau, the relevant altitude is 1500 m.
For an observer on the plateau, the relevant altitude is 0 m.</p>

<p>See documentation for <code><a href="#solar_zenith_angle">solar_zenith_angle</a></code> and <code><a href="#horizon_zenith_angle">horizon_zenith_angle</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>lat</strong> (float or ndarray):
latitude in degrees</li>
<li><strong>lon</strong> (float or ndarray):
longitudes in degrees</li>
<li><strong>alt</strong> (float or ndarray):
altitude above surrounding terrain that defines the horizon, meters</li>
<li><strong>datetimeUTC</strong> (pandas.Timestamp, datetime, or str):
date and time in UTC</li>
<li><strong>refraction</strong> (bool, optional (default=False)):
specifies whether to account for atmospheric refraction</li>
<li><strong>temperature</strong> (float or ndarray, optional (default=10)):
surface atmospheric temperature (Celsius), only used for refraction calculation</li>
<li><strong>pressure</strong> (float or ndarray, optional (default=101325)):
surface atmospheric pressure (Pa), only used for refraction calculation</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>sea</strong> (float or ndarray):
solar elevation angle in degrees at the designated locations and times
If refraction=False, this is the true solar elevation angle
If refraction=True, this is the apparent solar elevation angle</li>
</ul>
</div>


                </section>
                <section id="equationOfTime">
                            <input id="equationOfTime-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">equationOfTime</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">date</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="equationOfTime-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#equationOfTime"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="equationOfTime-161"><a href="#equationOfTime-161"><span class="linenos">161</span></a><span class="k">def</span> <span class="nf">equation_of_time</span><span class="p">(</span> <span class="n">date</span> <span class="p">):</span>
</span><span id="equationOfTime-162"><a href="#equationOfTime-162"><span class="linenos">162</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Equation of time (degrees) for specified date</span>
</span><span id="equationOfTime-163"><a href="#equationOfTime-163"><span class="linenos">163</span></a><span class="sd">    </span>
</span><span id="equationOfTime-164"><a href="#equationOfTime-164"><span class="linenos">164</span></a><span class="sd">    Implements the &quot;alternative equation&quot; from Wikipedia, derived from</span>
</span><span id="equationOfTime-165"><a href="#equationOfTime-165"><span class="linenos">165</span></a><span class="sd">    https://web.archive.org/web/20120323231813/http://www.green-life-innovators.org/tiki-index.php?page=The%2BLatitude%2Band%2BLongitude%2Bof%2Bthe%2BSun%2Bby%2BDavid%2BWilliams</span>
</span><span id="equationOfTime-166"><a href="#equationOfTime-166"><span class="linenos">166</span></a><span class="sd">    Results checked against NOAA solar calculator and agree within 10 seconds.</span>
</span><span id="equationOfTime-167"><a href="#equationOfTime-167"><span class="linenos">167</span></a><span class="sd">    </span>
</span><span id="equationOfTime-168"><a href="#equationOfTime-168"><span class="linenos">168</span></a><span class="sd">    Argument</span>
</span><span id="equationOfTime-169"><a href="#equationOfTime-169"><span class="linenos">169</span></a><span class="sd">    --------</span>
</span><span id="equationOfTime-170"><a href="#equationOfTime-170"><span class="linenos">170</span></a><span class="sd">    date : pandas.Timestamp, date, or datetime</span>
</span><span id="equationOfTime-171"><a href="#equationOfTime-171"><span class="linenos">171</span></a><span class="sd">        date for calculation</span>
</span><span id="equationOfTime-172"><a href="#equationOfTime-172"><span class="linenos">172</span></a>
</span><span id="equationOfTime-173"><a href="#equationOfTime-173"><span class="linenos">173</span></a><span class="sd">    Returns</span>
</span><span id="equationOfTime-174"><a href="#equationOfTime-174"><span class="linenos">174</span></a><span class="sd">    -------</span>
</span><span id="equationOfTime-175"><a href="#equationOfTime-175"><span class="linenos">175</span></a><span class="sd">    eot : float</span>
</span><span id="equationOfTime-176"><a href="#equationOfTime-176"><span class="linenos">176</span></a><span class="sd">        equation of time in degrees on the specified date</span>
</span><span id="equationOfTime-177"><a href="#equationOfTime-177"><span class="linenos">177</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="equationOfTime-178"><a href="#equationOfTime-178"><span class="linenos">178</span></a>    <span class="c1"># Convert to pandas Timestamp, if needed</span>
</span><span id="equationOfTime-179"><a href="#equationOfTime-179"><span class="linenos">179</span></a>    <span class="n">date</span> <span class="o">=</span> <span class="n">_to_timestamp</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
</span><span id="equationOfTime-180"><a href="#equationOfTime-180"><span class="linenos">180</span></a>
</span><span id="equationOfTime-181"><a href="#equationOfTime-181"><span class="linenos">181</span></a>    <span class="c1"># Equation of time, accounts for the solar day differing slightly from 24 hr</span>
</span><span id="equationOfTime-182"><a href="#equationOfTime-182"><span class="linenos">182</span></a>    <span class="n">doy</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">dayofyear</span>
</span><span id="equationOfTime-183"><a href="#equationOfTime-183"><span class="linenos">183</span></a>    <span class="n">W</span> <span class="o">=</span> <span class="mi">360</span> <span class="o">/</span> <span class="mf">365.24</span>
</span><span id="equationOfTime-184"><a href="#equationOfTime-184"><span class="linenos">184</span></a>    <span class="n">A</span> <span class="o">=</span> <span class="n">W</span> <span class="o">*</span> <span class="p">(</span><span class="n">doy</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span>
</span><span id="equationOfTime-185"><a href="#equationOfTime-185"><span class="linenos">185</span></a>    <span class="n">B</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="mf">1.914</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">W</span> <span class="o">*</span> <span class="p">(</span><span class="n">doy</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span>
</span><span id="equationOfTime-186"><a href="#equationOfTime-186"><span class="linenos">186</span></a>    <span class="n">C</span> <span class="o">=</span> <span class="p">(</span> <span class="n">A</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">B</span><span class="o">*</span><span class="n">pi180</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">23.44</span><span class="o">*</span><span class="n">pi180</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">pi180</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">180</span>
</span><span id="equationOfTime-187"><a href="#equationOfTime-187"><span class="linenos">187</span></a>
</span><span id="equationOfTime-188"><a href="#equationOfTime-188"><span class="linenos">188</span></a>    <span class="c1"># Equation of time in minutes of an hour</span>
</span><span id="equationOfTime-189"><a href="#equationOfTime-189"><span class="linenos">189</span></a>    <span class="n">eotmin</span> <span class="o">=</span> <span class="mi">720</span> <span class="o">*</span> <span class="p">(</span> <span class="n">C</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="p">)</span>
</span><span id="equationOfTime-190"><a href="#equationOfTime-190"><span class="linenos">190</span></a>
</span><span id="equationOfTime-191"><a href="#equationOfTime-191"><span class="linenos">191</span></a>    <span class="c1"># Equation of time, minutes -&gt; degrees</span>
</span><span id="equationOfTime-192"><a href="#equationOfTime-192"><span class="linenos">192</span></a>    <span class="n">eot</span> <span class="o">=</span> <span class="n">eotmin</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">/</span> <span class="mi">24</span>
</span><span id="equationOfTime-193"><a href="#equationOfTime-193"><span class="linenos">193</span></a>
</span><span id="equationOfTime-194"><a href="#equationOfTime-194"><span class="linenos">194</span></a>    <span class="k">return</span> <span class="n">eot</span>
</span></pre></div>


            <div class="docstring"><p>Equation of time (degrees) for specified date</p>

<p>Implements the "alternative equation" from Wikipedia, derived from
<a href="https://web.archive.org/web/20120323231813/http://www.green-life-innovators.org/tiki-index.php?page=The%2BLatitude%2Band%2BLongitude%2Bof%2Bthe%2BSun%2Bby%2BDavid%2BWilliams">https://web.archive.org/web/20120323231813/http://www.green-life-innovators.org/tiki-index.php?page=The%2BLatitude%2Band%2BLongitude%2Bof%2Bthe%2BSun%2Bby%2BDavid%2BWilliams</a>
Results checked against NOAA solar calculator and agree within 10 seconds.</p>

<h6 id="argument">Argument</h6>

<p>date : pandas.Timestamp, date, or datetime
    date for calculation</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>eot</strong> (float):
equation of time in degrees on the specified date</li>
</ul>
</div>


                </section>
                <section id="solarDeclination">
                            <input id="solarDeclination-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">solarDeclination</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">date</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="solarDeclination-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#solarDeclination"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="solarDeclination-247"><a href="#solarDeclination-247"><span class="linenos">247</span></a><span class="k">def</span> <span class="nf">solar_declination</span><span class="p">(</span> <span class="n">date</span> <span class="p">):</span>
</span><span id="solarDeclination-248"><a href="#solarDeclination-248"><span class="linenos">248</span></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;Calculate solar declination (degrees) for specified date</span>
</span><span id="solarDeclination-249"><a href="#solarDeclination-249"><span class="linenos">249</span></a><span class="sd">    </span>
</span><span id="solarDeclination-250"><a href="#solarDeclination-250"><span class="linenos">250</span></a><span class="sd">    Implements Eq. 9.68-9.72 from M.Z. Jacobson, Fundamentals of Atmospheric Modeling</span>
</span><span id="solarDeclination-251"><a href="#solarDeclination-251"><span class="linenos">251</span></a><span class="sd">    </span>
</span><span id="solarDeclination-252"><a href="#solarDeclination-252"><span class="linenos">252</span></a><span class="sd">    Argument</span>
</span><span id="solarDeclination-253"><a href="#solarDeclination-253"><span class="linenos">253</span></a><span class="sd">    --------</span>
</span><span id="solarDeclination-254"><a href="#solarDeclination-254"><span class="linenos">254</span></a><span class="sd">    date : pandas.Timestamp, date, datetime, or str</span>
</span><span id="solarDeclination-255"><a href="#solarDeclination-255"><span class="linenos">255</span></a><span class="sd">        date for calculation</span>
</span><span id="solarDeclination-256"><a href="#solarDeclination-256"><span class="linenos">256</span></a>
</span><span id="solarDeclination-257"><a href="#solarDeclination-257"><span class="linenos">257</span></a><span class="sd">    Returns</span>
</span><span id="solarDeclination-258"><a href="#solarDeclination-258"><span class="linenos">258</span></a><span class="sd">    -------</span>
</span><span id="solarDeclination-259"><a href="#solarDeclination-259"><span class="linenos">259</span></a><span class="sd">    dec : float</span>
</span><span id="solarDeclination-260"><a href="#solarDeclination-260"><span class="linenos">260</span></a><span class="sd">        solar declination in degrees at the specified date</span>
</span><span id="solarDeclination-261"><a href="#solarDeclination-261"><span class="linenos">261</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="solarDeclination-262"><a href="#solarDeclination-262"><span class="linenos">262</span></a>
</span><span id="solarDeclination-263"><a href="#solarDeclination-263"><span class="linenos">263</span></a>    <span class="c1"># Convert to pandas Timestamp, if needed</span>
</span><span id="solarDeclination-264"><a href="#solarDeclination-264"><span class="linenos">264</span></a>    <span class="n">date</span> <span class="o">=</span> <span class="n">_to_timestamp</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
</span><span id="solarDeclination-265"><a href="#solarDeclination-265"><span class="linenos">265</span></a>
</span><span id="solarDeclination-266"><a href="#solarDeclination-266"><span class="linenos">266</span></a>     <span class="c1"># Number of days since beginning of 2000</span>
</span><span id="solarDeclination-267"><a href="#solarDeclination-267"><span class="linenos">267</span></a>    <span class="n">NJD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span> <span class="n">date</span><span class="o">.</span><span class="n">to_julian_date</span><span class="p">()</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_julian_date</span><span class="p">()</span> <span class="p">)</span>
</span><span id="solarDeclination-268"><a href="#solarDeclination-268"><span class="linenos">268</span></a>
</span><span id="solarDeclination-269"><a href="#solarDeclination-269"><span class="linenos">269</span></a>    <span class="c1"># Obliquity, degrees</span>
</span><span id="solarDeclination-270"><a href="#solarDeclination-270"><span class="linenos">270</span></a>    <span class="n">ob</span> <span class="o">=</span> <span class="mf">23.439</span> <span class="o">-</span> <span class="mf">4e-7</span> <span class="o">*</span> <span class="n">NJD</span>
</span><span id="solarDeclination-271"><a href="#solarDeclination-271"><span class="linenos">271</span></a>
</span><span id="solarDeclination-272"><a href="#solarDeclination-272"><span class="linenos">272</span></a>    <span class="c1"># Parameters for ecliptic, degrees</span>
</span><span id="solarDeclination-273"><a href="#solarDeclination-273"><span class="linenos">273</span></a>    <span class="n">gm</span> <span class="o">=</span> <span class="mf">357.528</span> <span class="o">+</span> <span class="mf">0.9856003</span> <span class="o">*</span> <span class="n">NJD</span>
</span><span id="solarDeclination-274"><a href="#solarDeclination-274"><span class="linenos">274</span></a>    <span class="n">lm</span> <span class="o">=</span> <span class="mf">280.460</span> <span class="o">+</span> <span class="mf">0.9856474</span> <span class="o">*</span> <span class="n">NJD</span>
</span><span id="solarDeclination-275"><a href="#solarDeclination-275"><span class="linenos">275</span></a>
</span><span id="solarDeclination-276"><a href="#solarDeclination-276"><span class="linenos">276</span></a>    <span class="c1"># Ecliptic longitude of sun, degrees</span>
</span><span id="solarDeclination-277"><a href="#solarDeclination-277"><span class="linenos">277</span></a>    <span class="n">ec</span> <span class="o">=</span> <span class="n">lm</span> <span class="o">+</span> <span class="mf">1.915</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">gm</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span> <span class="o">+</span> <span class="mf">0.020</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gm</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span>
</span><span id="solarDeclination-278"><a href="#solarDeclination-278"><span class="linenos">278</span></a>
</span><span id="solarDeclination-279"><a href="#solarDeclination-279"><span class="linenos">279</span></a>    <span class="c1">#Solar declination, degrees</span>
</span><span id="solarDeclination-280"><a href="#solarDeclination-280"><span class="linenos">280</span></a>    <span class="n">dec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">ob</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">ec</span> <span class="o">*</span> <span class="n">pi180</span> <span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">pi180</span>
</span><span id="solarDeclination-281"><a href="#solarDeclination-281"><span class="linenos">281</span></a>
</span><span id="solarDeclination-282"><a href="#solarDeclination-282"><span class="linenos">282</span></a>    <span class="k">return</span> <span class="n">dec</span>
</span></pre></div>


            <div class="docstring"><p>Calculate solar declination (degrees) for specified date</p>

<p>Implements Eq. 9.68-9.72 from M.Z. Jacobson, Fundamentals of Atmospheric Modeling</p>

<h6 id="argument">Argument</h6>

<p>date : pandas.Timestamp, date, datetime, or str
    date for calculation</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>dec</strong> (float):
solar declination in degrees at the specified date</li>
</ul>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>